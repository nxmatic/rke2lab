apiVersion: kpt.dev/v1
kind: Kptfile
metadata:
  name: headscale
  annotations:
    config.kubernetes.io/local-config: "true"
info:
  description: |
    Headscale deployment with LoadBalancer for RKE2 cluster mesh networking.

    Components:
    - Headscale server (deployment + LoadBalancer service)
    - Home LAN IP pool for LoadBalancer
    - Headscale client DaemonSet (runs on control-plane nodes)
    - Bootstrap job to create admin user and preauth key

    This package provides Tailscale-compatible mesh networking for the cluster
    using the open-source Headscale coordination server.
pipeline:
  mutators:
    - image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
      configPath: setters.yaml
