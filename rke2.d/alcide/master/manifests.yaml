apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|${envoy-gateway-namespace}'
    kpt.dev/package-layer: networking
    kpt.dev/package-name: envoy-gateway
  name: envoy-gateway-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|flox-runtime'
    kpt.dev/package-layer: runtime
    kpt.dev/package-name: flox-containerd-shim
  labels:
    flox.dev/component: runtime
  name: flox-runtime
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|flux-system'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: flux-system
  name: flux-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|${headscale-namespace}'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|kube-system'
    kpt.dev/package-layer: networking
    kpt.dev/package-name: kdns
  name: kube-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|${kube-vip-namespace}'
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
  labels:
    name: kube-vip
  name: kube-vip
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|openebs'
    kpt.dev/package-layer: storage
    kpt.dev/package-name: openebs-zfs
  name: openebs
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|porch-fn-system'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-fn-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|porch-system'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|${tailscale-namespace}'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: tailscale
  name: tailscale-system
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|tekton-dashboard'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard
---
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Namespace|default|tekton-operator'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-operator
---
allowVolumeExpansion: true
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: storage.k8s.io|StorageClass|default|openebs-zfs
    kpt.dev/package-layer: storage
    kpt.dev/package-name: openebs-zfs
    storageclass.kubernetes.io/is-default-class: "true"
  name: openebs-zfs
parameters:
  fstype: zfs
  zfs.poolname: tank
provisioner: zfs.csi.openebs.io
reclaimPolicy: Delete
volumeBindingMode: WaitForFirstConsumer
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|extensions.dashboard.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: extensions.dashboard.tekton.dev
spec:
  group: dashboard.tekton.dev
  names:
    categories:
    - tekton
    - tekton-dashboard
    kind: Extension
    plural: extensions
    shortNames:
    - ext
    - exts
  preserveUnknownFields: false
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.apiVersion
      name: API version
      type: string
    - jsonPath: .spec.name
      name: Kind
      type: string
    - jsonPath: .spec.displayName
      name: Display name
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    helm.sh/resource-policy: keep
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: fluxinstances.fluxcd.controlplane.io
spec:
  group: fluxcd.controlplane.io
  names:
    kind: FluxInstance
    listKind: FluxInstanceList
    plural: fluxinstances
    singular: fluxinstance
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Status
      type: string
    - jsonPath: .status.lastAttemptedRevision
      name: Revision
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: FluxInstance is the Schema for the fluxinstances API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: FluxInstanceSpec defines the desired state of FluxInstance
            properties:
              cluster:
                description: Cluster holds the specification of the Kubernetes cluster.
                properties:
                  domain:
                    default: cluster.local
                    description: |-
                      Domain is the cluster domain used for generating the FQDN of services.
                      Defaults to 'cluster.local'.
                    type: string
                  multitenant:
                    default: false
                    description: Multitenant enables the multitenancy lockdown. Defaults
                      to false.
                    type: boolean
                  multitenantWorkloadIdentity:
                    default: false
                    description: |-
                      MultitenantWorkloadIdentity enables the multitenancy lockdown for
                      workload identity. Defaults to false.
                    type: boolean
                  networkPolicy:
                    default: true
                    description: |-
                      NetworkPolicy restricts network access to the current namespace.
                      Defaults to true.
                    type: boolean
                  objectLevelWorkloadIdentity:
                    description: |-
                      ObjectLevelWorkloadIdentity enables the feature gate
                      required for object-level workload identity.
                      This feature is only available in Flux v2.6.0 and later.
                    type: boolean
                  size:
                    description: |-
                      Size defines the vertical scaling profile of the Flux controllers.
                      The size is used to determine the concurrency and CPU/Memory limits for the Flux controllers.
                      Accepted values are: 'small', 'medium' and 'large'.
                    enum:
                    - small
                    - medium
                    - large
                    type: string
                  tenantDefaultDecryptionServiceAccount:
                    description: |-
                      TenantDefaultDecryptionServiceAccount is the name of the service account
                      to use as default for kustomize-controller SOPS decryption when the
                      multitenant lockdown for workload identity is enabled. Defaults to the
                      'default' service account from the tenant namespace.
                    type: string
                  tenantDefaultKubeConfigServiceAccount:
                    description: |-
                      TenantDefaultKubeConfigServiceAccount is the name of the service account
                      to use as default for kustomize-controller and helm-controller remote
                      cluster access via spec.kubeConfig.configMapRef when the multitenant
                      lockdown for workload identity is enabled. Defaults to the 'default'
                      service account from the tenant namespace.
                    type: string
                  tenantDefaultServiceAccount:
                    description: |-
                      TenantDefaultServiceAccount is the name of the service account
                      to use as default when the multitenant lockdown is enabled, for
                      kustomize-controller and helm-controller.
                      This field will also be used for multitenant workload identity
                      lockdown for source-controller, notification-controller,
                      image-reflector-controller and image-automation-controller.
                      Defaults to the 'default' service account from the tenant namespace.
                    type: string
                  type:
                    default: kubernetes
                    description: |-
                      Type specifies the distro of the Kubernetes cluster.
                      Defaults to 'kubernetes'.
                    enum:
                    - kubernetes
                    - openshift
                    - aws
                    - azure
                    - gcp
                    type: string
                type: object
                x-kubernetes-validations:
                - message: .objectLevelWorkloadIdentity must be set to true when .multitenantWorkloadIdentity
                    is set to true
                  rule: (has(self.objectLevelWorkloadIdentity) && self.objectLevelWorkloadIdentity)
                    || !has(self.multitenantWorkloadIdentity) || !self.multitenantWorkloadIdentity
              commonMetadata:
                description: |-
                  CommonMetadata specifies the common labels and annotations that are
                  applied to all resources. Any existing label or annotation will be
                  overridden if its key matches a common one.
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Annotations to be added to the object's metadata.
                    type: object
                  labels:
                    additionalProperties:
                      type: string
                    description: Labels to be added to the object's metadata.
                    type: object
                type: object
              components:
                description: |-
                  Components is the list of controllers to install.
                  Defaults to a commonly used subset.
                items:
                  description: Component is the name of a controller to install.
                  enum:
                  - source-controller
                  - kustomize-controller
                  - helm-controller
                  - notification-controller
                  - image-reflector-controller
                  - image-automation-controller
                  - source-watcher
                  type: string
                type: array
              distribution:
                description: Distribution specifies the version and container registry
                  to pull images from.
                properties:
                  artifact:
                    description: |-
                      Artifact is the URL to the OCI artifact containing
                      the latest Kubernetes manifests for the distribution,
                      e.g. 'oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests:latest'.
                    pattern: ^oci://.*$
                    type: string
                  artifactPullSecret:
                    description: |-
                      ArtifactPullSecret is the name of the Kubernetes secret
                      to use for pulling the Kubernetes manifests for the distribution specified in the Artifact field.
                    type: string
                  imagePullSecret:
                    description: |-
                      ImagePullSecret is the name of the Kubernetes secret
                      to use for pulling images.
                    type: string
                  registry:
                    description: |-
                      Registry address to pull the distribution images from
                      e.g. 'ghcr.io/fluxcd'.
                    type: string
                  variant:
                    description: |-
                      Variant specifies the Flux distribution flavor stored
                      in the registry.
                    enum:
                    - upstream-alpine
                    - enterprise-alpine
                    - enterprise-distroless
                    - enterprise-distroless-fips
                    type: string
                  version:
                    description: Version semver expression e.g. '2.x', '2.3.x'.
                    type: string
                required:
                - registry
                - version
                type: object
              kustomize:
                description: |-
                  Kustomize holds a set of patches that can be applied to the
                  Flux installation, to customize the way Flux operates.
                properties:
                  patches:
                    description: |-
                      Strategic merge and JSON patches, defined as inline YAML objects,
                      capable of targeting objects based on kind, label and annotation selectors.
                    items:
                      description: |-
                        Patch contains an inline StrategicMerge or JSON6902 patch, and the target the patch should
                        be applied to.
                      properties:
                        patch:
                          description: |-
                            Patch contains an inline StrategicMerge patch or an inline JSON6902 patch with
                            an array of operation objects.
                          type: string
                        target:
                          description: Target points to the resources that the patch
                            document should be applied to.
                          properties:
                            annotationSelector:
                              description: |-
                                AnnotationSelector is a string that follows the label selection expression
                                https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#api
                                It matches with the resource annotations.
                              type: string
                            group:
                              description: |-
                                Group is the API group to select resources from.
                                Together with Version and Kind it is capable of unambiguously identifying and/or selecting resources.
                                https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/api-group.md
                              type: string
                            kind:
                              description: |-
                                Kind of the API Group to select resources from.
                                Together with Group and Version it is capable of unambiguously
                                identifying and/or selecting resources.
                                https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/api-group.md
                              type: string
                            labelSelector:
                              description: |-
                                LabelSelector is a string that follows the label selection expression
                                https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#api
                                It matches with the resource labels.
                              type: string
                            name:
                              description: Name to match resources with.
                              type: string
                            namespace:
                              description: Namespace to select resources from.
                              type: string
                            version:
                              description: |-
                                Version of the API Group to select resources from.
                                Together with Group and Kind it is capable of unambiguously identifying and/or selecting resources.
                                https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/api-group.md
                              type: string
                          type: object
                      required:
                      - patch
                      type: object
                    type: array
                type: object
              migrateResources:
                default: true
                description: |-
                  MigrateResources instructs the controller to migrate the Flux custom resources
                  from the previous version to the latest API version specified in the CRD.
                  Defaults to true.
                type: boolean
              sharding:
                description: Sharding holds the specification of the sharding configuration.
                properties:
                  key:
                    default: sharding.fluxcd.io/key
                    description: Key is the label key used to shard the resources.
                    type: string
                  shards:
                    description: Shards is the list of shard names.
                    items:
                      type: string
                    minItems: 1
                    type: array
                  storage:
                    description: |-
                      Storage defines if the source-controller shards
                      should use an emptyDir or a persistent volume claim for storage.
                      Accepted values are 'ephemeral' or 'persistent', defaults to 'ephemeral'.
                      For 'persistent' to take effect, the '.spec.storage' field must be set.
                    enum:
                    - ephemeral
                    - persistent
                    type: string
                required:
                - shards
                type: object
              storage:
                description: |-
                  Storage holds the specification of the source-controller
                  persistent volume claim.
                properties:
                  class:
                    description: Class is the storage class to use for the PVC.
                    type: string
                  size:
                    description: Size is the size of the PVC.
                    type: string
                required:
                - class
                - size
                type: object
              sync:
                description: |-
                  Sync specifies the source for the cluster sync operation.
                  When set, a Flux source (GitRepository, OCIRepository or Bucket)
                  and Flux Kustomization are created to sync the cluster state
                  with the source repository.
                properties:
                  interval:
                    default: 1m
                    description: Interval is the time between syncs.
                    pattern: ^([0-9]+(\.[0-9]+)?(ms|s|m|h))+$
                    type: string
                  kind:
                    description: Kind is the kind of the source.
                    enum:
                    - OCIRepository
                    - GitRepository
                    - Bucket
                    type: string
                  name:
                    description: |-
                      Name is the name of the Flux source and kustomization resources.
                      When not specified, the name is set to the namespace name of the FluxInstance.
                    maxLength: 63
                    type: string
                    x-kubernetes-validations:
                    - message: Sync name is immutable
                      rule: self == oldSelf
                  path:
                    description: |-
                      Path is the path to the source directory containing
                      the kustomize overlay or plain Kubernetes manifests.
                    type: string
                  provider:
                    description: |-
                      Provider specifies OIDC provider for source authentication.
                      For OCIRepository and Bucket the provider can be set to 'aws', 'azure' or 'gcp'.
                      for GitRepository the accepted value can be set to 'azure' or 'github'.
                      To disable OIDC authentication the provider can be set to 'generic' or left empty.
                    enum:
                    - generic
                    - aws
                    - azure
                    - gcp
                    - github
                    type: string
                  pullSecret:
                    description: |-
                      PullSecret specifies the Kubernetes Secret containing the
                      authentication credentials for the source.
                      For Git over HTTP/S sources, the secret must contain username and password fields.
                      For Git over SSH sources, the secret must contain known_hosts and identity fields.
                      For OCI sources, the secret must be of type kubernetes.io/dockerconfigjson.
                      For Bucket sources, the secret must contain accesskey and secretkey fields.
                    type: string
                  ref:
                    description: |-
                      Ref is the source reference, can be a Git ref name e.g. 'refs/heads/main',
                      an OCI tag e.g. 'latest' or a bucket name e.g. 'flux'.
                    type: string
                  url:
                    description: |-
                      URL is the source URL, can be a Git repository HTTP/S or SSH address,
                      an OCI repository address or a Bucket endpoint.
                    type: string
                required:
                - kind
                - path
                - ref
                - url
                type: object
              wait:
                default: true
                description: |-
                  Wait instructs the controller to check the health of all the reconciled
                  resources. Defaults to true.
                type: boolean
            required:
            - distribution
            type: object
          status:
            description: FluxInstanceStatus defines the observed state of FluxInstance
            properties:
              components:
                description: Components contains the container images used by the
                  components.
                items:
                  description: ComponentImage represents a container image used by
                    a component.
                  properties:
                    digest:
                      description: Digest of the container image.
                      type: string
                    name:
                      description: Name of the component.
                      type: string
                    repository:
                      description: Repository address of the container image.
                      type: string
                    tag:
                      description: Tag of the container image.
                      type: string
                  required:
                  - name
                  - repository
                  - tag
                  type: object
                type: array
              conditions:
                description: Conditions contains the readiness conditions of the object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              history:
                description: |-
                  History contains the reconciliation history of the FluxInstance
                  as a list of snapshots ordered by the last reconciled time.
                items:
                  description: |-
                    Snapshot represents a point-in-time record of a group of resources reconciliation,
                    including timing information, status, and a unique digest identifier.
                  properties:
                    digest:
                      description: Digest is the checksum in the format `<algo>:<hex>`
                        of the resources in this snapshot.
                      type: string
                    firstReconciled:
                      description: FirstReconciled is the time when this revision
                        was first reconciled to the cluster.
                      format: date-time
                      type: string
                    lastReconciled:
                      description: LastReconciled is the time when this revision was
                        last reconciled to the cluster.
                      format: date-time
                      type: string
                    lastReconciledDuration:
                      description: LastReconciledDuration is time it took to reconcile
                        the resources in this revision.
                      type: string
                    lastReconciledStatus:
                      description: LastReconciledStatus is the status of the last
                        reconciliation.
                      type: string
                    metadata:
                      additionalProperties:
                        type: string
                      description: Metadata contains additional information about
                        the snapshot.
                      type: object
                    totalReconciliations:
                      description: TotalReconciliations is the total number of reconciliations
                        that have occurred for this snapshot.
                      format: int64
                      type: integer
                  required:
                  - digest
                  - firstReconciled
                  - lastReconciled
                  - lastReconciledDuration
                  - lastReconciledStatus
                  - totalReconciliations
                  type: object
                type: array
              inventory:
                description: |-
                  Inventory contains a list of Kubernetes resource object references
                  last applied on the cluster.
                properties:
                  entries:
                    description: Entries of Kubernetes resource object references.
                    items:
                      description: ResourceRef contains the information necessary
                        to locate a resource within a cluster.
                      properties:
                        id:
                          description: |-
                            ID is the string representation of the Kubernetes resource object's metadata,
                            in the format '<namespace>_<name>_<group>_<kind>'.
                          type: string
                        v:
                          description: Version is the API version of the Kubernetes
                            resource object's kind.
                          type: string
                      required:
                      - id
                      - v
                      type: object
                    type: array
                required:
                - entries
                type: object
              lastAppliedRevision:
                description: |-
                  LastAppliedRevision is the version and digest of the
                  distribution config that was last reconcile.
                type: string
              lastArtifactRevision:
                description: |-
                  LastArtifactRevision is the digest of the last pulled
                  distribution artifact.
                type: string
              lastAttemptedRevision:
                description: |-
                  LastAttemptedRevision is the version and digest of the
                  distribution config that was last attempted to reconcile.
                type: string
              lastHandledForceAt:
                description: |-
                  LastHandledForceAt holds the value of the most recent
                  force request value, so a change of the annotation value
                  can be detected.
                type: string
              lastHandledReconcileAt:
                description: |-
                  LastHandledReconcileAt holds the value of the most recent
                  reconcile request value, so a change of the annotation value
                  can be detected.
                type: string
            type: object
        type: object
        x-kubernetes-validations:
        - message: the only accepted name for a FluxInstance is 'flux'
          rule: self.metadata.name == 'flux'
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    helm.sh/resource-policy: keep
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: fluxreports.fluxcd.controlplane.io
spec:
  group: fluxcd.controlplane.io
  names:
    kind: FluxReport
    listKind: FluxReportList
    plural: fluxreports
    singular: fluxreport
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.distribution.entitlement
      name: Entitlement
      priority: 10
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Status
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].lastTransitionTime
      name: LastUpdated
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: FluxReport is the Schema for the fluxreports API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: FluxReportSpec defines the observed state of a Flux installation.
            properties:
              cluster:
                description: Cluster is the version information of the Kubernetes
                  cluster.
                properties:
                  nodes:
                    description: Nodes is the number of nodes in the Kubernetes cluster.
                    type: integer
                  platform:
                    description: Platform is the os/arch of the Kubernetes control
                      plane.
                    type: string
                  serverVersion:
                    description: ServerVersion is the version of the Kubernetes API
                      server.
                    type: string
                required:
                - platform
                - serverVersion
                type: object
              components:
                description: ComponentsStatus is the status of the Flux controller
                  deployments.
                items:
                  description: FluxComponentStatus defines the observed state of a
                    Flux component.
                  properties:
                    image:
                      description: Image is the container image of the Flux component.
                      type: string
                    name:
                      description: Name is the name of the Flux component.
                      type: string
                    ready:
                      description: Ready is the readiness status of the Flux component.
                      type: boolean
                    status:
                      description: |-
                        Status is a human-readable message indicating details
                        about the Flux component observed state.
                      type: string
                  required:
                  - image
                  - name
                  - ready
                  - status
                  type: object
                type: array
              distribution:
                description: Distribution is the version information of the Flux installation.
                properties:
                  entitlement:
                    description: Entitlement is the entitlement verification status.
                    type: string
                  managedBy:
                    description: ManagedBy is the name of the operator managing the
                      Flux instance.
                    type: string
                  status:
                    description: |-
                      Status is a human-readable message indicating details
                      about the distribution observed state.
                    type: string
                  version:
                    description: Version is the version of the Flux instance.
                    type: string
                required:
                - entitlement
                - status
                type: object
              operator:
                description: Operator is the version information of the Flux Operator.
                properties:
                  apiVersion:
                    description: APIVersion is the API version of the Flux Operator.
                    type: string
                  platform:
                    description: Platform is the os/arch of Flux Operator.
                    type: string
                  version:
                    description: Version is the version number of Flux Operator.
                    type: string
                required:
                - apiVersion
                - platform
                - version
                type: object
              reconcilers:
                description: |-
                  ReconcilersStatus is the list of Flux reconcilers and
                  their statistics grouped by API kind.
                items:
                  description: FluxReconcilerStatus defines the observed state of
                    a Flux reconciler.
                  properties:
                    apiVersion:
                      description: APIVersion is the API version of the Flux resource.
                      type: string
                    kind:
                      description: Kind is the kind of the Flux resource.
                      type: string
                    stats:
                      description: Stats is the reconcile statics of the Flux resource
                        kind.
                      properties:
                        failing:
                          description: |-
                            Failing is the number of reconciled
                            resources in the Failing state.
                          type: integer
                        running:
                          description: |-
                            Running is the number of reconciled
                            resources in the Running state.
                          type: integer
                        suspended:
                          description: |-
                            Suspended is the number of reconciled
                            resources in the Suspended state.
                          type: integer
                        totalSize:
                          description: TotalSize is the total size of the artifacts
                            in storage.
                          type: string
                      required:
                      - failing
                      - running
                      - suspended
                      type: object
                  required:
                  - apiVersion
                  - kind
                  type: object
                type: array
              sync:
                description: |-
                  SyncStatus is the status of the cluster sync
                  Source and Kustomization resources.
                properties:
                  id:
                    description: ID is the identifier of the sync.
                    type: string
                  path:
                    description: Path is the kustomize path of the sync.
                    type: string
                  ready:
                    description: Ready is the readiness status of the sync.
                    type: boolean
                  source:
                    description: Source is the URL of the source repository.
                    type: string
                  status:
                    description: |-
                      Status is a human-readable message indicating details
                      about the sync observed state.
                    type: string
                required:
                - id
                - ready
                - status
                type: object
            required:
            - distribution
            type: object
          status:
            description: FluxReportStatus defines the readiness of a FluxReport.
            properties:
              conditions:
                description: Conditions contains the readiness conditions of the object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              lastHandledReconcileAt:
                description: |-
                  LastHandledReconcileAt holds the value of the most recent
                  reconcile request value, so a change of the annotation value
                  can be detected.
                type: string
            type: object
        type: object
        x-kubernetes-validations:
        - message: the only accepted name for a FluxReport is 'flux'
          rule: self.metadata.name == 'flux'
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|manualapprovalgates.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: manualapprovalgates.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: ManualApprovalGate
    listKind: ManualApprovalGateList
    plural: manualapprovalgates
    shortNames:
    - mag
    singular: manualapprovalgate
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the ManualApprovalGate API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.1
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|packagerevs.config.porch.kpt.dev
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: packagerevs.config.porch.kpt.dev
spec:
  group: config.porch.kpt.dev
  names:
    kind: PackageRev
    listKind: PackageRevList
    plural: packagerevs
    singular: packagerev
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: PackageRev
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PackageRevSpec defines the desired state of PackageRev
            type: object
          status:
            description: PackageRevStatus defines the observed state of PackageRev
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|packagevariants.config.porch.kpt.dev
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: packagevariants.config.porch.kpt.dev
spec:
  group: config.porch.kpt.dev
  names:
    kind: PackageVariant
    listKind: PackageVariantList
    plural: packagevariants
    singular: packagevariant
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          PackageVariant represents an upstream and downstream porch package pair.
          The upstream package should already exist. The PackageVariant controller is
          responsible for creating the downstream package revisions based on the spec.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PackageVariantSpec defines the desired state of PackageVariant
            properties:
              adoptionPolicy:
                type: string
              annotations:
                additionalProperties:
                  type: string
                type: object
              deletionPolicy:
                type: string
              downstream:
                properties:
                  package:
                    type: string
                  repo:
                    type: string
                type: object
              injectors:
                items:
                  description: |-
                    InjectionSelector specifies how to select in-cluster objects for
                    resolving injection points.
                  properties:
                    group:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                    version:
                      type: string
                  required:
                  - name
                  type: object
                type: array
              labels:
                additionalProperties:
                  type: string
                type: object
              packageContext:
                description: |-
                  PackageContext defines the data to be added or removed from the
                  kptfile.kpt.dev ConfigMap during reconciliation.
                properties:
                  data:
                    additionalProperties:
                      type: string
                    type: object
                  removeKeys:
                    items:
                      type: string
                    type: array
                type: object
              pipeline:
                description: Pipeline declares a pipeline of functions used to mutate
                  or validate resources.
                properties:
                  mutators:
                    description: Mutators defines a list of of KRM functions that
                      mutate resources.
                    items:
                      description: Function specifies a KRM function.
                      properties:
                        configMap:
                          additionalProperties:
                            type: string
                          description: '`ConfigMap` is a convenient way to specify
                            a function config of kind ConfigMap.'
                          type: object
                        configPath:
                          description: |-
                            `ConfigPath` specifies a slash-delimited relative path to a file in the current directory
                            containing a KRM resource used as the function config. This resource is
                            excluded when resolving 'sources', and as a result cannot be operated on
                            by the pipeline.
                          type: string
                        exclude:
                          description: |-
                            `Exclude` are used to specify resources on which the function should NOT be executed.
                            If not specified, all resources selected by `Selectors` are selected.
                          items:
                            description: |-
                              Selector specifies the selection criteria
                              please update IsEmpty method if more properties are added
                            properties:
                              annotations:
                                additionalProperties:
                                  type: string
                                description: Annotations on the target resources
                                type: object
                              apiVersion:
                                description: APIVersion of the target resources
                                type: string
                              kind:
                                description: Kind of the target resources
                                type: string
                              labels:
                                additionalProperties:
                                  type: string
                                description: Labels on the target resources
                                type: object
                              name:
                                description: Name of the target resources
                                type: string
                              namespace:
                                description: Namespace of the target resources
                                type: string
                            type: object
                          type: array
                        exec:
                          description: "Exec specifies the function binary executable.\nThe
                            executable can be fully qualified or it must exists in
                            the $PATH e.g:\n\n\t exec: set-namespace\n\t exec: /usr/local/bin/my-custom-fn"
                          type: string
                        image:
                          description: "`Image` specifies the function container image.\nIt
                            can either be fully qualified, e.g.:\n\n\timage: ghcr.io/kptdev/krm-functions-catalog/set-labels\n\nOptionally,
                            kpt can be configured to use a image\nregistry host-path
                            that will be used to resolve the image path in case\nthe
                            image path is missing (Defaults to ghcr.io/kptdev/krm-functions-catalog).\ne.g.
                            The following resolves to ghcr.io/kptdev/krm-functions-catalog/set-labels:\n\n\timage:
                            set-labels"
                          type: string
                        name:
                          description: |-
                            `Name` is used to uniquely identify the function declaration
                            this is primarily used for merging function declaration with upstream counterparts
                          type: string
                        selectors:
                          description: |-
                            `Selectors` are used to specify resources on which the function should be executed
                            if not specified, all resources are selected
                          items:
                            description: |-
                              Selector specifies the selection criteria
                              please update IsEmpty method if more properties are added
                            properties:
                              annotations:
                                additionalProperties:
                                  type: string
                                description: Annotations on the target resources
                                type: object
                              apiVersion:
                                description: APIVersion of the target resources
                                type: string
                              kind:
                                description: Kind of the target resources
                                type: string
                              labels:
                                additionalProperties:
                                  type: string
                                description: Labels on the target resources
                                type: object
                              name:
                                description: Name of the target resources
                                type: string
                              namespace:
                                description: Namespace of the target resources
                                type: string
                            type: object
                          type: array
                      type: object
                    type: array
                  validators:
                    description: |-
                      Validators defines a list of KRM functions that validate resources.
                      Validators are not permitted to mutate resources.
                    items:
                      description: Function specifies a KRM function.
                      properties:
                        configMap:
                          additionalProperties:
                            type: string
                          description: '`ConfigMap` is a convenient way to specify
                            a function config of kind ConfigMap.'
                          type: object
                        configPath:
                          description: |-
                            `ConfigPath` specifies a slash-delimited relative path to a file in the current directory
                            containing a KRM resource used as the function config. This resource is
                            excluded when resolving 'sources', and as a result cannot be operated on
                            by the pipeline.
                          type: string
                        exclude:
                          description: |-
                            `Exclude` are used to specify resources on which the function should NOT be executed.
                            If not specified, all resources selected by `Selectors` are selected.
                          items:
                            description: |-
                              Selector specifies the selection criteria
                              please update IsEmpty method if more properties are added
                            properties:
                              annotations:
                                additionalProperties:
                                  type: string
                                description: Annotations on the target resources
                                type: object
                              apiVersion:
                                description: APIVersion of the target resources
                                type: string
                              kind:
                                description: Kind of the target resources
                                type: string
                              labels:
                                additionalProperties:
                                  type: string
                                description: Labels on the target resources
                                type: object
                              name:
                                description: Name of the target resources
                                type: string
                              namespace:
                                description: Namespace of the target resources
                                type: string
                            type: object
                          type: array
                        exec:
                          description: "Exec specifies the function binary executable.\nThe
                            executable can be fully qualified or it must exists in
                            the $PATH e.g:\n\n\t exec: set-namespace\n\t exec: /usr/local/bin/my-custom-fn"
                          type: string
                        image:
                          description: "`Image` specifies the function container image.\nIt
                            can either be fully qualified, e.g.:\n\n\timage: ghcr.io/kptdev/krm-functions-catalog/set-labels\n\nOptionally,
                            kpt can be configured to use a image\nregistry host-path
                            that will be used to resolve the image path in case\nthe
                            image path is missing (Defaults to ghcr.io/kptdev/krm-functions-catalog).\ne.g.
                            The following resolves to ghcr.io/kptdev/krm-functions-catalog/set-labels:\n\n\timage:
                            set-labels"
                          type: string
                        name:
                          description: |-
                            `Name` is used to uniquely identify the function declaration
                            this is primarily used for merging function declaration with upstream counterparts
                          type: string
                        selectors:
                          description: |-
                            `Selectors` are used to specify resources on which the function should be executed
                            if not specified, all resources are selected
                          items:
                            description: |-
                              Selector specifies the selection criteria
                              please update IsEmpty method if more properties are added
                            properties:
                              annotations:
                                additionalProperties:
                                  type: string
                                description: Annotations on the target resources
                                type: object
                              apiVersion:
                                description: APIVersion of the target resources
                                type: string
                              kind:
                                description: Kind of the target resources
                                type: string
                              labels:
                                additionalProperties:
                                  type: string
                                description: Labels on the target resources
                                type: object
                              name:
                                description: Name of the target resources
                                type: string
                              namespace:
                                description: Namespace of the target resources
                                type: string
                            type: object
                          type: array
                      type: object
                    type: array
                type: object
              upstream:
                properties:
                  package:
                    type: string
                  repo:
                    type: string
                  revision:
                    type: integer
                  workspaceName:
                    type: string
                type: object
            type: object
          status:
            description: PackageVariantStatus defines the observed state of PackageVariant
            properties:
              conditions:
                description: Conditions describes the reconciliation state of the
                  object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              downstreamTargets:
                description: |-
                  DownstreamTargets contains the downstream targets that the PackageVariant
                  either created or adopted.
                items:
                  properties:
                    name:
                      type: string
                    renderStatus:
                      description: |-
                        RenderStatus represents the result of performing render operation
                        on a package resources.
                      properties:
                        error:
                          type: string
                        result:
                          description: ResultList contains aggregated results from
                            multiple functions
                          properties:
                            apiVersion:
                              description: |-
                                APIVersion defines the versioned schema of this representation of an object.
                                Servers should convert recognized schemas to the latest internal value, and
                                may reject unrecognized values.
                                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                              type: string
                            exitCode:
                              description: ExitCode is the exit code of kpt command
                              type: integer
                            items:
                              description: Items contain a list of function result
                              items:
                                description: Result contains the structured result
                                  from an individual function
                                properties:
                                  exec:
                                    description: |-
                                      ExecPath is the the absolute os-specific path to the executable file
                                      If user provides an executable file with commands, ExecPath should
                                      contain the entire input string.
                                    type: string
                                  exitCode:
                                    description: ExitCode is the exit code from running
                                      the function
                                    type: integer
                                  image:
                                    description: |-
                                      Image is the full name of the image that generates this result
                                      Image and Exec are mutually exclusive
                                    type: string
                                  results:
                                    description: Results is the list of results for
                                      the function
                                    items:
                                      description: ResultItem defines a validation
                                        result
                                      properties:
                                        field:
                                          description: Field is a reference to the
                                            field in a resource this result refers
                                            to
                                          properties:
                                            currentValue:
                                              description: CurrentValue is the current
                                                field value
                                              type: string
                                            path:
                                              description: Path is the field path.
                                                This field is required.
                                              type: string
                                            proposedValue:
                                              description: ProposedValue is the proposed
                                                value of the field to fix an issue.
                                              type: string
                                          type: object
                                        file:
                                          description: File references a file containing
                                            the resource this result refers to
                                          properties:
                                            index:
                                              description: |-
                                                Index is the index into the file containing the resource
                                                (i.e. if there are multiple resources in a single file)
                                              type: integer
                                            path:
                                              description: |-
                                                Path is relative path to the file containing the resource.
                                                This field is required.
                                              type: string
                                          type: object
                                        message:
                                          description: Message is a human readable
                                            message. This field is required.
                                          type: string
                                        resourceRef:
                                          description: |-
                                            ResourceRef is a reference to a resource.
                                            Required fields: apiVersion, kind, name.
                                          properties:
                                            apiVersion:
                                              description: |-
                                                APIVersion defines the versioned schema of this representation of an object.
                                                Servers should convert recognized schemas to the latest internal value, and
                                                may reject unrecognized values.
                                                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                                              type: string
                                            kind:
                                              description: |-
                                                Kind is a string value representing the REST resource this object represents.
                                                Servers may infer this from the endpoint the client submits requests to.
                                                Cannot be updated.
                                                In CamelCase.
                                                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                                              type: string
                                            name:
                                              description: Name is the metadata.name
                                                field of a Resource
                                              type: string
                                            namespace:
                                              description: Namespace is the metadata.namespace
                                                field of a Resource
                                              type: string
                                          type: object
                                        severity:
                                          description: Severity is the severity of
                                            this result
                                          type: string
                                        tags:
                                          additionalProperties:
                                            type: string
                                          description: |-
                                            Tags is an unstructured key value map stored with a result that may be set
                                            by external tools to store and retrieve arbitrary metadata
                                          type: object
                                      type: object
                                    type: array
                                  stderr:
                                    description: |-
                                      Enable this once test harness supports filepath based assertions.
                                      Pkg is OS specific Absolute path to the package.
                                      Pkg string `yaml:"pkg,omitempty"`
                                      Stderr is the content in function stderr
                                    type: string
                                required:
                                - exitCode
                                type: object
                              type: array
                            kind:
                              description: |-
                                Kind is a string value representing the REST resource this object represents.
                                Servers may infer this from the endpoint the client submits requests to.
                                Cannot be updated.
                                In CamelCase.
                                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                              type: string
                            metadata:
                              type: object
                          required:
                          - exitCode
                          type: object
                      required:
                      - error
                      type: object
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|packagevariantsets.config.porch.kpt.dev
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: packagevariantsets.config.porch.kpt.dev
spec:
  group: config.porch.kpt.dev
  names:
    kind: PackageVariantSet
    listKind: PackageVariantSetList
    plural: packagevariantsets
    singular: packagevariantset
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          PackageVariantSet represents an upstream package revision and a way to
          target specific downstream repositories where a variant of the upstream
          package should be created.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PackageVariantSetSpec defines the desired state of PackageVariantSet
            properties:
              adoptionPolicy:
                type: string
              annotations:
                additionalProperties:
                  type: string
                type: object
              deletionPolicy:
                type: string
              labels:
                additionalProperties:
                  type: string
                type: object
              targets:
                items:
                  properties:
                    objects:
                      description: 'option 3: a selector against a set of arbitrary
                        objects'
                      properties:
                        repoName:
                          properties:
                            fromField:
                              type: string
                            value:
                              type: string
                          type: object
                        selectors:
                          items:
                            properties:
                              annotations:
                                additionalProperties:
                                  type: string
                                description: Annotations on the target resources
                                type: object
                              apiVersion:
                                description: APIVersion of the target resources
                                type: string
                              kind:
                                description: Kind of the target resources
                                type: string
                              labelSelector:
                                description: Labels on the target resources
                                properties:
                                  matchExpressions:
                                    description: matchExpressions is a list of label
                                      selector requirements. The requirements are
                                      ANDed.
                                    items:
                                      description: |-
                                        A label selector requirement is a selector that contains values, a key, and an operator that
                                        relates the key and values.
                                      properties:
                                        key:
                                          description: key is the label key that the
                                            selector applies to.
                                          type: string
                                        operator:
                                          description: |-
                                            operator represents a key's relationship to a set of values.
                                            Valid operators are In, NotIn, Exists and DoesNotExist.
                                          type: string
                                        values:
                                          description: |-
                                            values is an array of string values. If the operator is In or NotIn,
                                            the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                            the values array must be empty. This array is replaced during a strategic
                                            merge patch.
                                          items:
                                            type: string
                                          type: array
                                          x-kubernetes-list-type: atomic
                                      required:
                                      - key
                                      - operator
                                      type: object
                                    type: array
                                    x-kubernetes-list-type: atomic
                                  matchLabels:
                                    additionalProperties:
                                      type: string
                                    description: |-
                                      matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                      map is equivalent to an element of matchExpressions, whose key field is "key", the
                                      operator is "In", and the values array contains only "value". The requirements are ANDed.
                                    type: object
                                type: object
                                x-kubernetes-map-type: atomic
                              name:
                                description: Name of the target resources
                                type: string
                              namespace:
                                description: Namespace of the target resources
                                type: string
                            type: object
                          type: array
                      type: object
                    package:
                      description: 'option 1: an explicit repo/package name pair'
                      properties:
                        name:
                          type: string
                        repo:
                          type: string
                      type: object
                    packageName:
                      description: |-
                        For options 2 and 3, PackageName specifies how to create the name of the
                        package variant
                      properties:
                        baseName:
                          properties:
                            fromField:
                              type: string
                            value:
                              type: string
                          type: object
                        namePrefix:
                          properties:
                            fromField:
                              type: string
                            value:
                              type: string
                          type: object
                        nameSuffix:
                          properties:
                            fromField:
                              type: string
                            value:
                              type: string
                          type: object
                      type: object
                    repositories:
                      description: 'option 2: a label selector against a set of repositories'
                      properties:
                        matchExpressions:
                          description: matchExpressions is a list of label selector
                            requirements. The requirements are ANDed.
                          items:
                            description: |-
                              A label selector requirement is a selector that contains values, a key, and an operator that
                              relates the key and values.
                            properties:
                              key:
                                description: key is the label key that the selector
                                  applies to.
                                type: string
                              operator:
                                description: |-
                                  operator represents a key's relationship to a set of values.
                                  Valid operators are In, NotIn, Exists and DoesNotExist.
                                type: string
                              values:
                                description: |-
                                  values is an array of string values. If the operator is In or NotIn,
                                  the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                  the values array must be empty. This array is replaced during a strategic
                                  merge patch.
                                items:
                                  type: string
                                type: array
                                x-kubernetes-list-type: atomic
                            required:
                            - key
                            - operator
                            type: object
                          type: array
                          x-kubernetes-list-type: atomic
                        matchLabels:
                          additionalProperties:
                            type: string
                          description: |-
                            matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                            map is equivalent to an element of matchExpressions, whose key field is "key", the
                            operator is "In", and the values array contains only "value". The requirements are ANDed.
                          type: object
                      type: object
                      x-kubernetes-map-type: atomic
                  type: object
                type: array
              upstream:
                properties:
                  package:
                    properties:
                      name:
                        type: string
                      repo:
                        type: string
                    type: object
                  ref:
                    type: string
                  revision:
                    type: integer
                type: object
            type: object
          status:
            description: PackageVariantSetStatus defines the observed state of PackageVariantSet
            properties:
              conditions:
                description: Conditions describes the reconciliation state of the
                  object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
            type: object
        type: object
    served: false
    storage: false
    subresources:
      status: {}
  - name: v1alpha2
    schema:
      openAPIV3Schema:
        description: |-
          PackageVariantSet represents an upstream package revision and a way to
          target specific downstream repositories where a variant of the upstream
          package should be created.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PackageVariantSetSpec defines the desired state of PackageVariantSet
            properties:
              targets:
                items:
                  properties:
                    objectSelector:
                      description: 'option 3: a selector against a set of arbitrary
                        objects'
                      properties:
                        apiVersion:
                          description: APIVersion of the target resources
                          type: string
                        kind:
                          description: Kind of the target resources
                          type: string
                        matchExpressions:
                          description: matchExpressions is a list of label selector
                            requirements. The requirements are ANDed.
                          items:
                            description: |-
                              A label selector requirement is a selector that contains values, a key, and an operator that
                              relates the key and values.
                            properties:
                              key:
                                description: key is the label key that the selector
                                  applies to.
                                type: string
                              operator:
                                description: |-
                                  operator represents a key's relationship to a set of values.
                                  Valid operators are In, NotIn, Exists and DoesNotExist.
                                type: string
                              values:
                                description: |-
                                  values is an array of string values. If the operator is In or NotIn,
                                  the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                  the values array must be empty. This array is replaced during a strategic
                                  merge patch.
                                items:
                                  type: string
                                type: array
                                x-kubernetes-list-type: atomic
                            required:
                            - key
                            - operator
                            type: object
                          type: array
                          x-kubernetes-list-type: atomic
                        matchLabels:
                          additionalProperties:
                            type: string
                          description: |-
                            matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                            map is equivalent to an element of matchExpressions, whose key field is "key", the
                            operator is "In", and the values array contains only "value". The requirements are ANDed.
                          type: object
                        name:
                          description: Name of the target resource
                          type: string
                      type: object
                      x-kubernetes-map-type: atomic
                    repositories:
                      description: |-
                        Exactly one of Repositories, RepositorySeletor, and ObjectSelector must be
                        populated
                        option 1: an explicit repositories and package names
                      items:
                        properties:
                          name:
                            description: |-
                              Name contains the name of the Repository resource, which must be in
                              the same namespace as the PackageVariantSet resource.
                            type: string
                          packageNames:
                            description: |-
                              PackageNames contains names to use for package instances in this repository;
                              that is, the same upstream will be instantiated multiple times using these names.
                            items:
                              type: string
                            type: array
                        required:
                        - name
                        type: object
                      type: array
                    repositorySelector:
                      description: 'option 2: a label selector against a set of repositories'
                      properties:
                        matchExpressions:
                          description: matchExpressions is a list of label selector
                            requirements. The requirements are ANDed.
                          items:
                            description: |-
                              A label selector requirement is a selector that contains values, a key, and an operator that
                              relates the key and values.
                            properties:
                              key:
                                description: key is the label key that the selector
                                  applies to.
                                type: string
                              operator:
                                description: |-
                                  operator represents a key's relationship to a set of values.
                                  Valid operators are In, NotIn, Exists and DoesNotExist.
                                type: string
                              values:
                                description: |-
                                  values is an array of string values. If the operator is In or NotIn,
                                  the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                  the values array must be empty. This array is replaced during a strategic
                                  merge patch.
                                items:
                                  type: string
                                type: array
                                x-kubernetes-list-type: atomic
                            required:
                            - key
                            - operator
                            type: object
                          type: array
                          x-kubernetes-list-type: atomic
                        matchLabels:
                          additionalProperties:
                            type: string
                          description: |-
                            matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                            map is equivalent to an element of matchExpressions, whose key field is "key", the
                            operator is "In", and the values array contains only "value". The requirements are ANDed.
                          type: object
                      type: object
                      x-kubernetes-map-type: atomic
                    template:
                      description: Template specifies how to generate a PackageVariant
                        from a target
                      properties:
                        adoptionPolicy:
                          description: AdoptionPolicy allows overriding the PackageVariant
                            adoption policy
                          type: string
                        annotationExprs:
                          description: |-
                            AnnotationsExprs allows specifying the spec.Annotations field of the generated PackageVariant
                            using CEL to dynamically create the keys and values. Entries in this field take precedent over
                            those with the same keys that are present in Annotations.
                          items:
                            description: |-
                              MapExpr is used for various fields to calculate map entries. Only one of
                              Key and KeyExpr may be specified; similarly only on of Value and ValueExpr
                              may be specified.
                            properties:
                              key:
                                type: string
                              keyExpr:
                                type: string
                              value:
                                type: string
                              valueExpr:
                                type: string
                            type: object
                          type: array
                        annotations:
                          additionalProperties:
                            type: string
                          description: Annotations allows specifying the spec.Annotations
                            field of the generated PackageVariant
                          type: object
                        deletionPolicy:
                          description: DeletionPolicy allows overriding the PackageVariant
                            deletion policy
                          type: string
                        downstream:
                          description: Downstream allows overriding the default downstream
                            package and repository name
                          properties:
                            package:
                              type: string
                            packageExpr:
                              type: string
                            repo:
                              type: string
                            repoExpr:
                              type: string
                          type: object
                        injectors:
                          description: Injectors allows specifying the spec.Injectors
                            field of the generated PackageVariant
                          items:
                            description: |-
                              InjectionSelectorTemplate is used to calculate the injectors field of the
                              resulting package variants. Exactly one of the Name and NameExpr fields must
                              be specified. The other fields are optional.
                            properties:
                              group:
                                type: string
                              kind:
                                type: string
                              name:
                                type: string
                              nameExpr:
                                type: string
                              version:
                                type: string
                            type: object
                          type: array
                        labelExprs:
                          description: |-
                            LabelsExprs allows specifying the spec.Labels field of the generated PackageVariant
                            using CEL to dynamically create the keys and values. Entries in this field take precedent over
                            those with the same keys that are present in Labels.
                          items:
                            description: |-
                              MapExpr is used for various fields to calculate map entries. Only one of
                              Key and KeyExpr may be specified; similarly only on of Value and ValueExpr
                              may be specified.
                            properties:
                              key:
                                type: string
                              keyExpr:
                                type: string
                              value:
                                type: string
                              valueExpr:
                                type: string
                            type: object
                          type: array
                        labels:
                          additionalProperties:
                            type: string
                          description: Labels allows specifying the spec.Labels field
                            of the generated PackageVariant
                          type: object
                        packageContext:
                          description: PackageContext allows specifying the spec.PackageContext
                            field of the generated PackageVariant
                          properties:
                            data:
                              additionalProperties:
                                type: string
                              type: object
                            dataExprs:
                              items:
                                description: |-
                                  MapExpr is used for various fields to calculate map entries. Only one of
                                  Key and KeyExpr may be specified; similarly only on of Value and ValueExpr
                                  may be specified.
                                properties:
                                  key:
                                    type: string
                                  keyExpr:
                                    type: string
                                  value:
                                    type: string
                                  valueExpr:
                                    type: string
                                type: object
                              type: array
                            removeKeyExprs:
                              items:
                                type: string
                              type: array
                            removeKeys:
                              items:
                                type: string
                              type: array
                          type: object
                        pipeline:
                          description: Pipeline allows specifying the spec.Pipeline
                            field of the generated PackageVariant
                          properties:
                            mutators:
                              description: |-
                                Mutators is used to caculate the pipeline.mutators field of the
                                resulting package variants.
                              items:
                                description: |-
                                  FunctionTemplate is used in generating KRM function pipeline entries; that
                                  is, it is used to generate Kptfile Function objects.
                                properties:
                                  configMap:
                                    additionalProperties:
                                      type: string
                                    description: '`ConfigMap` is a convenient way
                                      to specify a function config of kind ConfigMap.'
                                    type: object
                                  configMapExprs:
                                    description: |-
                                      ConfigMapExprs allows use of CEL to dynamically create the keys and values in the
                                      function config ConfigMap. Entries in this field take precedent over those with
                                      the same keys that are present in ConfigMap.
                                    items:
                                      description: |-
                                        MapExpr is used for various fields to calculate map entries. Only one of
                                        Key and KeyExpr may be specified; similarly only on of Value and ValueExpr
                                        may be specified.
                                      properties:
                                        key:
                                          type: string
                                        keyExpr:
                                          type: string
                                        value:
                                          type: string
                                        valueExpr:
                                          type: string
                                      type: object
                                    type: array
                                  configPath:
                                    description: |-
                                      `ConfigPath` specifies a slash-delimited relative path to a file in the current directory
                                      containing a KRM resource used as the function config. This resource is
                                      excluded when resolving 'sources', and as a result cannot be operated on
                                      by the pipeline.
                                    type: string
                                  exclude:
                                    description: |-
                                      `Exclude` are used to specify resources on which the function should NOT be executed.
                                      If not specified, all resources selected by `Selectors` are selected.
                                    items:
                                      description: |-
                                        Selector specifies the selection criteria
                                        please update IsEmpty method if more properties are added
                                      properties:
                                        annotations:
                                          additionalProperties:
                                            type: string
                                          description: Annotations on the target resources
                                          type: object
                                        apiVersion:
                                          description: APIVersion of the target resources
                                          type: string
                                        kind:
                                          description: Kind of the target resources
                                          type: string
                                        labels:
                                          additionalProperties:
                                            type: string
                                          description: Labels on the target resources
                                          type: object
                                        name:
                                          description: Name of the target resources
                                          type: string
                                        namespace:
                                          description: Namespace of the target resources
                                          type: string
                                      type: object
                                    type: array
                                  exec:
                                    description: "Exec specifies the function binary
                                      executable.\nThe executable can be fully qualified
                                      or it must exists in the $PATH e.g:\n\n\t exec:
                                      set-namespace\n\t exec: /usr/local/bin/my-custom-fn"
                                    type: string
                                  image:
                                    description: "`Image` specifies the function container
                                      image.\nIt can either be fully qualified, e.g.:\n\n\timage:
                                      ghcr.io/kptdev/krm-functions-catalog/set-labels\n\nOptionally,
                                      kpt can be configured to use a image\nregistry
                                      host-path that will be used to resolve the image
                                      path in case\nthe image path is missing (Defaults
                                      to ghcr.io/kptdev/krm-functions-catalog).\ne.g.
                                      The following resolves to ghcr.io/kptdev/krm-functions-catalog/set-labels:\n\n\timage:
                                      set-labels"
                                    type: string
                                  name:
                                    description: |-
                                      `Name` is used to uniquely identify the function declaration
                                      this is primarily used for merging function declaration with upstream counterparts
                                    type: string
                                  selectors:
                                    description: |-
                                      `Selectors` are used to specify resources on which the function should be executed
                                      if not specified, all resources are selected
                                    items:
                                      description: |-
                                        Selector specifies the selection criteria
                                        please update IsEmpty method if more properties are added
                                      properties:
                                        annotations:
                                          additionalProperties:
                                            type: string
                                          description: Annotations on the target resources
                                          type: object
                                        apiVersion:
                                          description: APIVersion of the target resources
                                          type: string
                                        kind:
                                          description: Kind of the target resources
                                          type: string
                                        labels:
                                          additionalProperties:
                                            type: string
                                          description: Labels on the target resources
                                          type: object
                                        name:
                                          description: Name of the target resources
                                          type: string
                                        namespace:
                                          description: Namespace of the target resources
                                          type: string
                                      type: object
                                    type: array
                                type: object
                              type: array
                            validators:
                              description: |-
                                Validators is used to caculate the pipeline.validators field of the
                                resulting package variants.
                              items:
                                description: |-
                                  FunctionTemplate is used in generating KRM function pipeline entries; that
                                  is, it is used to generate Kptfile Function objects.
                                properties:
                                  configMap:
                                    additionalProperties:
                                      type: string
                                    description: '`ConfigMap` is a convenient way
                                      to specify a function config of kind ConfigMap.'
                                    type: object
                                  configMapExprs:
                                    description: |-
                                      ConfigMapExprs allows use of CEL to dynamically create the keys and values in the
                                      function config ConfigMap. Entries in this field take precedent over those with
                                      the same keys that are present in ConfigMap.
                                    items:
                                      description: |-
                                        MapExpr is used for various fields to calculate map entries. Only one of
                                        Key and KeyExpr may be specified; similarly only on of Value and ValueExpr
                                        may be specified.
                                      properties:
                                        key:
                                          type: string
                                        keyExpr:
                                          type: string
                                        value:
                                          type: string
                                        valueExpr:
                                          type: string
                                      type: object
                                    type: array
                                  configPath:
                                    description: |-
                                      `ConfigPath` specifies a slash-delimited relative path to a file in the current directory
                                      containing a KRM resource used as the function config. This resource is
                                      excluded when resolving 'sources', and as a result cannot be operated on
                                      by the pipeline.
                                    type: string
                                  exclude:
                                    description: |-
                                      `Exclude` are used to specify resources on which the function should NOT be executed.
                                      If not specified, all resources selected by `Selectors` are selected.
                                    items:
                                      description: |-
                                        Selector specifies the selection criteria
                                        please update IsEmpty method if more properties are added
                                      properties:
                                        annotations:
                                          additionalProperties:
                                            type: string
                                          description: Annotations on the target resources
                                          type: object
                                        apiVersion:
                                          description: APIVersion of the target resources
                                          type: string
                                        kind:
                                          description: Kind of the target resources
                                          type: string
                                        labels:
                                          additionalProperties:
                                            type: string
                                          description: Labels on the target resources
                                          type: object
                                        name:
                                          description: Name of the target resources
                                          type: string
                                        namespace:
                                          description: Namespace of the target resources
                                          type: string
                                      type: object
                                    type: array
                                  exec:
                                    description: "Exec specifies the function binary
                                      executable.\nThe executable can be fully qualified
                                      or it must exists in the $PATH e.g:\n\n\t exec:
                                      set-namespace\n\t exec: /usr/local/bin/my-custom-fn"
                                    type: string
                                  image:
                                    description: "`Image` specifies the function container
                                      image.\nIt can either be fully qualified, e.g.:\n\n\timage:
                                      ghcr.io/kptdev/krm-functions-catalog/set-labels\n\nOptionally,
                                      kpt can be configured to use a image\nregistry
                                      host-path that will be used to resolve the image
                                      path in case\nthe image path is missing (Defaults
                                      to ghcr.io/kptdev/krm-functions-catalog).\ne.g.
                                      The following resolves to ghcr.io/kptdev/krm-functions-catalog/set-labels:\n\n\timage:
                                      set-labels"
                                    type: string
                                  name:
                                    description: |-
                                      `Name` is used to uniquely identify the function declaration
                                      this is primarily used for merging function declaration with upstream counterparts
                                    type: string
                                  selectors:
                                    description: |-
                                      `Selectors` are used to specify resources on which the function should be executed
                                      if not specified, all resources are selected
                                    items:
                                      description: |-
                                        Selector specifies the selection criteria
                                        please update IsEmpty method if more properties are added
                                      properties:
                                        annotations:
                                          additionalProperties:
                                            type: string
                                          description: Annotations on the target resources
                                          type: object
                                        apiVersion:
                                          description: APIVersion of the target resources
                                          type: string
                                        kind:
                                          description: Kind of the target resources
                                          type: string
                                        labels:
                                          additionalProperties:
                                            type: string
                                          description: Labels on the target resources
                                          type: object
                                        name:
                                          description: Name of the target resources
                                          type: string
                                        namespace:
                                          description: Namespace of the target resources
                                          type: string
                                      type: object
                                    type: array
                                type: object
                              type: array
                          type: object
                      type: object
                  type: object
                type: array
              upstream:
                properties:
                  package:
                    type: string
                  repo:
                    type: string
                  revision:
                    type: integer
                  workspaceName:
                    type: string
                type: object
            type: object
          status:
            description: PackageVariantSetStatus defines the observed state of PackageVariantSet
            properties:
              conditions:
                description: Conditions describes the reconciliation state of the
                  object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|repositories.config.porch.kpt.dev
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: repositories.config.porch.kpt.dev
spec:
  group: config.porch.kpt.dev
  names:
    kind: Repository
    listKind: RepositoryList
    plural: repositories
    singular: repository
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.type
      name: Type
      type: string
    - jsonPath: .spec.content
      name: Content
      type: string
    - jsonPath: .spec.sync.schedule
      name: Sync schedule
      type: string
    - jsonPath: .spec.deployment
      name: Deployment
      type: boolean
    - jsonPath: .status.conditions[?(@.type=='Ready')].status
      name: Ready
      type: string
    - jsonPath: .spec['git','oci']['repo','registry']
      name: Address
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Repository
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: |-
              RepositorySpec defines the desired state of Repository

              Notes:
                - deployment repository - in KRM API ConfigSync would be configured directly? (or via this API)
            properties:
              content:
                default: Package
                description: |-
                  The Content field is deprecated, please do not specify it in new manifests.
                  For partial backward compatibility it is still recognized, but its only valid value is "Package", and if not specified its default value is also "Package".
                type: string
                x-kubernetes-validations:
                - message: The 'content' field is deprecated, its only valid value
                    is 'Package'
                  rule: self == '' || self == 'Package'
              deployment:
                description: The repository is a deployment repository; final packages
                  in this repository are deployment ready.
                type: boolean
              description:
                description: User-friendly description of the repository
                type: string
              git:
                description: Git repository details. Required if `type` is `git`.
                  Ignored if `type` is not `git`.
                properties:
                  author:
                    description: Author to use for commits
                    type: string
                  branch:
                    default: main
                    description: Name of the branch containing the packages. Finalized
                      packages will be committed to this branch (if the repository
                      allows write access). If unspecified, defaults to "main".
                    minLength: 1
                    type: string
                  createBranch:
                    description: CreateBranch specifies if Porch should create the
                      package branch if it doesn't exist.
                    type: boolean
                  directory:
                    description: Directory within the Git repository where the packages
                      are stored. A subdirectory of this directory containing a Kptfile
                      is considered a package. If unspecified, defaults to root directory.
                    type: string
                  email:
                    description: Email to use for commits
                    type: string
                  repo:
                    description: |-
                      Address of the Git repository, for example:
                        `https://github.com/GoogleCloudPlatform/blueprints.git`
                    type: string
                  secretRef:
                    description: Reference to secret containing authentication credentials.
                    properties:
                      name:
                        description: Name of the secret. The secret is expected to
                          be located in the same namespace as the resource containing
                          the reference.
                        type: string
                    required:
                    - name
                    type: object
                required:
                - repo
                type: object
              oci:
                description: OCI repository details. Required if `type` is `oci`.
                  Ignored if `type` is not `oci`.
                properties:
                  registry:
                    description: Registry is the address of the OCI registry
                    type: string
                  secretRef:
                    description: Reference to secret containing authentication credentials.
                    properties:
                      name:
                        description: Name of the secret. The secret is expected to
                          be located in the same namespace as the resource containing
                          the reference.
                        type: string
                    required:
                    - name
                    type: object
                required:
                - registry
                type: object
              sync:
                description: Repository sync/reconcile details
                properties:
                  runOnceAt:
                    description: Value in metav1.Time format to indicate when the
                      repository should be synced once outside the periodic cron based
                      reconcile loop.
                    format: date-time
                    type: string
                  schedule:
                    description: 'Cron value to indicate when the repository should
                      be synced periodically. Example: `*/10 * * * *` to sync every
                      10 minutes.'
                    type: string
                type: object
              type:
                description: Type of the repository (i.e. git, OCI)
                type: string
            type: object
          status:
            description: RepositoryStatus defines the observed state of Repository
            properties:
              conditions:
                description: Conditions describes the reconciliation state of the
                  object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
            type: object
        type: object
        x-kubernetes-validations:
        - message: metadata.name must conform to the RFC1123 DNS label standard
          rule: self.metadata.name.matches('^[a-z0-9]([-a-z0-9]*[a-z0-9])?$')
        - message: metadata.name must be no more than 63 characters
          rule: size(self.metadata.name) <= 63
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    helm.sh/resource-policy: keep
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: resourcesetinputproviders.fluxcd.controlplane.io
spec:
  group: fluxcd.controlplane.io
  names:
    kind: ResourceSetInputProvider
    listKind: ResourceSetInputProviderList
    plural: resourcesetinputproviders
    shortNames:
    - rsip
    singular: resourcesetinputprovider
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Status
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: ResourceSetInputProvider is the Schema for the ResourceSetInputProviders
          API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ResourceSetInputProviderSpec defines the desired state of
              ResourceSetInputProvider
            properties:
              certSecretRef:
                description: |-
                  CertSecretRef specifies the Kubernetes Secret containing either or both of

                  - a PEM-encoded CA certificate (`ca.crt`)
                  - a PEM-encoded client certificate (`tls.crt`) and private key (`tls.key`)

                  When connecting to a Git or OCI provider that uses self-signed certificates, the CA certificate
                  must be set in the Secret under the 'ca.crt' key to establish the trust relationship.
                  When connecting to an OCI provider that supports client certificates (mTLS), the client certificate
                  and private key must be set in the Secret under the 'tls.crt' and 'tls.key' keys, respectively.
                properties:
                  name:
                    description: Name of the referent.
                    type: string
                required:
                - name
                type: object
              defaultValues:
                additionalProperties:
                  x-kubernetes-preserve-unknown-fields: true
                description: |-
                  DefaultValues contains the default values for the inputs.
                  These values are used to populate the inputs when the provider
                  response does not contain them.
                type: object
              filter:
                description: Filter defines the filter to apply to the input provider
                  response.
                properties:
                  excludeBranch:
                    description: |-
                      ExcludeBranch specifies the regular expression to filter the branches
                      that the input provider should exclude.
                    type: string
                  excludeTag:
                    description: |-
                      ExcludeTag specifies the regular expression to filter the tags
                      that the input provider should exclude.
                    type: string
                  includeBranch:
                    description: |-
                      IncludeBranch specifies the regular expression to filter the branches
                      that the input provider should include.
                    type: string
                  includeTag:
                    description: |-
                      IncludeTag specifies the regular expression to filter the tags
                      that the input provider should include.
                    type: string
                  labels:
                    description: Labels specifies the list of labels to filter the
                      input provider response.
                    items:
                      type: string
                    type: array
                  limit:
                    default: 100
                    description: |-
                      Limit specifies the maximum number of input sets to return.
                      When not set, the default limit is 100.
                    type: integer
                  semver:
                    description: |-
                      Semver specifies a semantic version range to filter and sort the tags.
                      If this field is not specified, the tags will be sorted in reverse
                      alphabetical order.
                      Supported only for tags at the moment.
                    type: string
                type: object
              schedule:
                description: Schedule defines the schedules for the input provider
                  to run.
                items:
                  description: Schedule defines a schedule for something to run.
                  properties:
                    cron:
                      description: Cron specifies the cron expression for the schedule.
                      type: string
                    timeZone:
                      default: UTC
                      description: TimeZone specifies the time zone for the cron schedule.
                        Defaults to UTC.
                      type: string
                    window:
                      default: 0s
                      description: |-
                        Window defines the time window during which the execution is allowed.
                        Defaults to 0s, meaning no window is applied.
                      pattern: ^([0-9]+(\.[0-9]+)?(ms|s|m|h))+$
                      type: string
                  required:
                  - cron
                  type: object
                type: array
              secretRef:
                description: |-
                  SecretRef specifies the Kubernetes Secret containing the basic-auth credentials
                  to access the input provider.
                  When connecting to a Git provider, the secret must contain the keys
                  'username' and 'password', and the password should be a personal access token
                  that grants read-only access to the repository.
                  When connecting to an OCI provider, the secret must contain a Kubernetes
                  Image Pull Secret, as if created by `kubectl create secret docker-registry`.
                properties:
                  name:
                    description: Name of the referent.
                    type: string
                required:
                - name
                type: object
              serviceAccountName:
                description: |-
                  ServiceAccountName specifies the name of the Kubernetes ServiceAccount
                  used for authentication with AWS, Azure or GCP services through
                  workload identity federation features. If not specified, the
                  authentication for these cloud providers will use the ServiceAccount
                  of the operator (or any other environment authentication configuration).
                type: string
              skip:
                description: Skip defines whether we need to skip input provider response
                  updates.
                properties:
                  labels:
                    description: |-
                      Labels specifies list of labels to skip input provider response when any of the label conditions matched.
                      When prefixed with !, input provider response will be skipped if it does not have this label.
                    items:
                      type: string
                    type: array
                type: object
              type:
                description: Type specifies the type of the input provider.
                enum:
                - Static
                - GitHubBranch
                - GitHubTag
                - GitHubPullRequest
                - GitLabBranch
                - GitLabTag
                - GitLabMergeRequest
                - AzureDevOpsBranch
                - AzureDevOpsTag
                - AzureDevOpsPullRequest
                - OCIArtifactTag
                - ACRArtifactTag
                - ECRArtifactTag
                - GARArtifactTag
                type: string
              url:
                description: |-
                  URL specifies the HTTP/S or OCI address of the input provider API.
                  When connecting to a Git provider, the URL should point to the repository address.
                  When connecting to an OCI provider, the URL should point to the OCI repository address.
                pattern: ^((http|https|oci)://.*){0,1}$
                type: string
            required:
            - type
            type: object
            x-kubernetes-validations:
            - message: spec.url must be empty when spec.type is 'Static'
              rule: self.type != 'Static' || !has(self.url)
            - message: spec.url must not be empty when spec.type is not 'Static'
              rule: self.type == 'Static' || has(self.url)
            - message: spec.url must start with 'http://' or 'https://' when spec.type
                is a Git provider
              rule: '!self.type.startsWith(''Git'') || self.url.startsWith(''http'')'
            - message: spec.url must start with 'http://' or 'https://' when spec.type
                is a Git provider
              rule: '!self.type.startsWith(''AzureDevOps'') || self.url.startsWith(''http'')'
            - message: spec.url must start with 'oci://' when spec.type is an OCI
                provider
              rule: '!self.type.endsWith(''ArtifactTag'') || self.url.startsWith(''oci'')'
            - message: cannot specify spec.serviceAccountName when spec.type is not
                one of AzureDevOps* or *ArtifactTag
              rule: '!has(self.serviceAccountName) || self.type.startsWith(''AzureDevOps'')
                || self.type.endsWith(''ArtifactTag'')'
            - message: cannot specify spec.certSecretRef when spec.type is one of
                Static, AzureDevOps*, ACRArtifactTag, ECRArtifactTag or GARArtifactTag
              rule: '!has(self.certSecretRef) || !(self.url == ''Static'' || self.type.startsWith(''AzureDevOps'')
                || (self.type.endsWith(''ArtifactTag'') && self.type != ''OCIArtifactTag''))'
            - message: cannot specify spec.secretRef when spec.type is one of Static,
                ACRArtifactTag, ECRArtifactTag or GARArtifactTag
              rule: '!has(self.secretRef) || !(self.url == ''Static'' || (self.type.endsWith(''ArtifactTag'')
                && self.type != ''OCIArtifactTag''))'
          status:
            description: ResourceSetInputProviderStatus defines the observed state
              of ResourceSetInputProvider.
            properties:
              conditions:
                description: Conditions contains the readiness conditions of the object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              exportedInputs:
                description: ExportedInputs contains the list of inputs exported by
                  the provider.
                items:
                  additionalProperties:
                    x-kubernetes-preserve-unknown-fields: true
                  description: ResourceSetInput defines the key-value pairs of the
                    ResourceSet input.
                  type: object
                type: array
              lastExportedRevision:
                description: |-
                  LastExportedRevision is the digest of the
                  inputs that were last reconcile.
                type: string
              lastHandledForceAt:
                description: |-
                  LastHandledForceAt holds the value of the most recent
                  force request value, so a change of the annotation value
                  can be detected.
                type: string
              lastHandledReconcileAt:
                description: |-
                  LastHandledReconcileAt holds the value of the most recent
                  reconcile request value, so a change of the annotation value
                  can be detected.
                type: string
              nextSchedule:
                description: NextSchedule is the next schedule when the input provider
                  will run.
                properties:
                  cron:
                    description: Cron specifies the cron expression for the schedule.
                    type: string
                  timeZone:
                    default: UTC
                    description: TimeZone specifies the time zone for the cron schedule.
                      Defaults to UTC.
                    type: string
                  when:
                    description: When is the next time the schedule will run.
                    format: date-time
                    type: string
                  window:
                    default: 0s
                    description: |-
                      Window defines the time window during which the execution is allowed.
                      Defaults to 0s, meaning no window is applied.
                    pattern: ^([0-9]+(\.[0-9]+)?(ms|s|m|h))+$
                    type: string
                required:
                - cron
                - when
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
    helm.sh/resource-policy: keep
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: resourcesets.fluxcd.controlplane.io
spec:
  group: fluxcd.controlplane.io
  names:
    kind: ResourceSet
    listKind: ResourceSetList
    plural: resourcesets
    shortNames:
    - rset
    singular: resourceset
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Status
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: ResourceSet is the Schema for the ResourceSets API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ResourceSetSpec defines the desired state of ResourceSet
            properties:
              commonMetadata:
                description: |-
                  CommonMetadata specifies the common labels and annotations that are
                  applied to all resources. Any existing label or annotation will be
                  overridden if its key matches a common one.
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Annotations to be added to the object's metadata.
                    type: object
                  labels:
                    additionalProperties:
                      type: string
                    description: Labels to be added to the object's metadata.
                    type: object
                type: object
              dependsOn:
                description: |-
                  DependsOn specifies the list of Kubernetes resources that must
                  exist on the cluster before the reconciliation process starts.
                items:
                  description: Dependency defines a ResourceSet dependency on a Kubernetes
                    resource.
                  properties:
                    apiVersion:
                      description: APIVersion of the resource to depend on.
                      type: string
                    kind:
                      description: Kind of the resource to depend on.
                      type: string
                    name:
                      description: Name of the resource to depend on.
                      type: string
                    namespace:
                      description: Namespace of the resource to depend on.
                      type: string
                    ready:
                      description: Ready checks if the resource Ready status condition
                        is true.
                      type: boolean
                    readyExpr:
                      description: |-
                        ReadyExpr checks if the resource satisfies the given CEL expression.
                        The expression replaces the default readiness check and
                        is only evaluated if Ready is set to 'true'.
                      type: string
                  required:
                  - apiVersion
                  - kind
                  - name
                  type: object
                type: array
              inputStrategy:
                description: |-
                  InputStrategy defines how the inputs are combined when multiple
                  input provider objects are used. Defaults to flattening all inputs
                  from all providers into a single list of input sets.
                properties:
                  name:
                    description: |-
                      Name defines how the inputs are combined when multiple
                      input provider objects are used. Supported values are:
                      - Flatten: all inputs sets from all input provider objects are
                        flattened into a single list of input sets.
                      - Permute: all inputs sets from all input provider objects are
                        combined using a Cartesian product, resulting in a list of input sets
                        that contains every possible combination of input values.
                        For example, if provider A has inputs [{x: 1}, {x: 2}] and provider B has
                        inputs [{y: "a"}, {y: "b"}], the resulting input sets will be:
                        [{x: 1, y: "a"}, {x: 1, y: "b"}, {x: 2, y: "a"}, {x: 2, y: "b"}].
                        This strategy can lead to a large number of input sets and should be
                        used with caution. Users should use filtering features from
                        ResourceSetInputProvider to limit the amount of exported inputs.
                    enum:
                    - Flatten
                    - Permute
                    type: string
                required:
                - name
                type: object
              inputs:
                description: Inputs contains the list of ResourceSet inputs.
                items:
                  additionalProperties:
                    x-kubernetes-preserve-unknown-fields: true
                  description: ResourceSetInput defines the key-value pairs of the
                    ResourceSet input.
                  type: object
                type: array
              inputsFrom:
                description: |-
                  InputsFrom contains the list of references to input providers.
                  When set, the inputs are fetched from the providers and concatenated
                  with the in-line inputs defined in the ResourceSet.
                items:
                  description: |-
                    InputProviderReference defines a reference to an input provider resource
                    in the same namespace as the ResourceSet.
                  properties:
                    apiVersion:
                      description: |-
                        APIVersion of the input provider resource.
                        When not set, the APIVersion of the ResourceSet is used.
                      enum:
                      - fluxcd.controlplane.io/v1
                      type: string
                    kind:
                      description: Kind of the input provider resource.
                      enum:
                      - ResourceSetInputProvider
                      type: string
                    name:
                      description: |-
                        Name of the input provider resource. Cannot be set
                        when the Selector field is set.
                      type: string
                    selector:
                      description: |-
                        Selector is a label selector to filter the input provider resources
                        as an alternative to the Name field.
                      properties:
                        matchExpressions:
                          description: matchExpressions is a list of label selector
                            requirements. The requirements are ANDed.
                          items:
                            description: |-
                              A label selector requirement is a selector that contains values, a key, and an operator that
                              relates the key and values.
                            properties:
                              key:
                                description: key is the label key that the selector
                                  applies to.
                                type: string
                              operator:
                                description: |-
                                  operator represents a key's relationship to a set of values.
                                  Valid operators are In, NotIn, Exists and DoesNotExist.
                                type: string
                              values:
                                description: |-
                                  values is an array of string values. If the operator is In or NotIn,
                                  the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                  the values array must be empty. This array is replaced during a strategic
                                  merge patch.
                                items:
                                  type: string
                                type: array
                                x-kubernetes-list-type: atomic
                            required:
                            - key
                            - operator
                            type: object
                          type: array
                          x-kubernetes-list-type: atomic
                        matchLabels:
                          additionalProperties:
                            type: string
                          description: |-
                            matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                            map is equivalent to an element of matchExpressions, whose key field is "key", the
                            operator is "In", and the values array contains only "value". The requirements are ANDed.
                          type: object
                      type: object
                      x-kubernetes-map-type: atomic
                  type: object
                  x-kubernetes-validations:
                  - message: at least one of name or selector must be set for input
                      provider references
                    rule: has(self.name) || has(self.selector)
                  - message: cannot set both name and selector for input provider
                      references
                    rule: '!has(self.name) || !has(self.selector)'
                type: array
              resources:
                description: Resources contains the list of Kubernetes resources to
                  reconcile.
                items:
                  x-kubernetes-preserve-unknown-fields: true
                type: array
              resourcesTemplate:
                description: |-
                  ResourcesTemplate is a Go template that generates the list of
                  Kubernetes resources to reconcile. The template is rendered
                  as multi-document YAML, the resources should be separated by '---'.
                  When both Resources and ResourcesTemplate are set, the resulting
                  objects are merged and deduplicated, with the ones from Resources taking precedence.
                type: string
              serviceAccountName:
                description: |-
                  The name of the Kubernetes service account to impersonate
                  when reconciling the generated resources.
                type: string
              wait:
                description: |-
                  Wait instructs the controller to check the health
                  of all the reconciled resources.
                type: boolean
            type: object
          status:
            description: ResourceSetStatus defines the observed state of ResourceSet.
            properties:
              conditions:
                description: Conditions contains the readiness conditions of the object.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              history:
                description: |-
                  History contains the reconciliation history of the ResourceSet
                  as a list of snapshots ordered by the last reconciled time.
                items:
                  description: |-
                    Snapshot represents a point-in-time record of a group of resources reconciliation,
                    including timing information, status, and a unique digest identifier.
                  properties:
                    digest:
                      description: Digest is the checksum in the format `<algo>:<hex>`
                        of the resources in this snapshot.
                      type: string
                    firstReconciled:
                      description: FirstReconciled is the time when this revision
                        was first reconciled to the cluster.
                      format: date-time
                      type: string
                    lastReconciled:
                      description: LastReconciled is the time when this revision was
                        last reconciled to the cluster.
                      format: date-time
                      type: string
                    lastReconciledDuration:
                      description: LastReconciledDuration is time it took to reconcile
                        the resources in this revision.
                      type: string
                    lastReconciledStatus:
                      description: LastReconciledStatus is the status of the last
                        reconciliation.
                      type: string
                    metadata:
                      additionalProperties:
                        type: string
                      description: Metadata contains additional information about
                        the snapshot.
                      type: object
                    totalReconciliations:
                      description: TotalReconciliations is the total number of reconciliations
                        that have occurred for this snapshot.
                      format: int64
                      type: integer
                  required:
                  - digest
                  - firstReconciled
                  - lastReconciled
                  - lastReconciledDuration
                  - lastReconciledStatus
                  - totalReconciliations
                  type: object
                type: array
              inventory:
                description: |-
                  Inventory contains a list of Kubernetes resource object references
                  last applied on the cluster.
                properties:
                  entries:
                    description: Entries of Kubernetes resource object references.
                    items:
                      description: ResourceRef contains the information necessary
                        to locate a resource within a cluster.
                      properties:
                        id:
                          description: |-
                            ID is the string representation of the Kubernetes resource object's metadata,
                            in the format '<namespace>_<name>_<group>_<kind>'.
                          type: string
                        v:
                          description: Version is the API version of the Kubernetes
                            resource object's kind.
                          type: string
                      required:
                      - id
                      - v
                      type: object
                    type: array
                required:
                - entries
                type: object
              lastAppliedRevision:
                description: |-
                  LastAppliedRevision is the digest of the
                  generated resources that were last reconcile.
                type: string
              lastHandledReconcileAt:
                description: |-
                  LastHandledReconcileAt holds the value of the most recent
                  reconcile request value, so a change of the annotation value
                  can be detected.
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonchains.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonchains.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonChain
    listKind: TektonChainList
    plural: tektonchains
    singular: tektonchain
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the TektonChains API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonconfigs.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonconfigs.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonConfig
    listKind: TektonConfigList
    plural: tektonconfigs
    singular: tektonconfig
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektonconfigs API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektondashboards.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektondashboards.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonDashboard
    listKind: TektonDashboardList
    plural: tektondashboards
    singular: tektondashboard
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektondashboards API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonhubs.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonhubs.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonHub
    listKind: TektonHubList
    plural: tektonhubs
    singular: tektonhub
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    - jsonPath: .status.apiUrl
      name: ApiUrl
      type: string
    - jsonPath: .status.uiUrl
      name: UiUrl
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektonhubs API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektoninstallersets.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektoninstallersets.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonInstallerSet
    listKind: TektonInstallerSetList
    plural: tektoninstallersets
    singular: tektoninstallerset
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektoninstallerset API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonpipelines.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonpipelines.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonPipeline
    listKind: TektonPipelineList
    plural: tektonpipelines
    singular: tektonpipeline
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektonpipelines API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonpruners.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonpruners.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonPruner
    listKind: TektonPrunerList
    plural: tektonpruners
    singular: tektonpruner
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektonpruners API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektonresults.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektonresults.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonResult
    listKind: TektonResultList
    plural: tektonresults
    singular: tektonresult
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the TektonResults API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiextensions.k8s.io|CustomResourceDefinition|default|tektontriggers.operator.tekton.dev
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tektontriggers.operator.tekton.dev
spec:
  group: operator.tekton.dev
  names:
    kind: TektonTrigger
    listKind: TektonTriggerList
    plural: tektontriggers
    singular: tektontrigger
  preserveUnknownFields: false
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].message
      name: Reason
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Schema for the tektontriggers API
        type: object
        x-kubernetes-preserve-unknown-fields: true
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|${envoy-gateway-namespace}|envoy-gateway-installer'
    kpt.dev/package-layer: networking
    kpt.dev/package-name: envoy-gateway
  name: envoy-gateway-installer
  namespace: envoy-gateway-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|flox-runtime|flox-runtime-installer'
    kpt.dev/package-layer: runtime
    kpt.dev/package-name: flox-containerd-shim
  name: flox-runtime-installer
  namespace: flox-runtime
---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: flux-operator
  namespace: flux-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|${headscale-namespace}|headscale-bootstrap'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-bootstrap
  namespace: headscale-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|${headscale-namespace}|headscale-client'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-client
  namespace: headscale-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|${headscale-namespace}|headscale-gateway'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-gateway
  namespace: headscale-system
---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    kpt.dev/package-layer: networking
    kpt.dev/package-name: kdns
  labels:
    app.kubernetes.io/instance: kdns
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kdns
    helm.sh/chart: kdns-0.2.3
  name: kdns
  namespace: kube-system
---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    kpt.dev/package-layer: replication
    kpt.dev/package-name: replicator
  labels:
    app.kubernetes.io/instance: kubernetes-replicator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kubernetes-replicator
    app.kubernetes.io/version: v2.12.2
    helm.sh/chart: kubernetes-replicator-2.12.2
  name: kubernetes-replicator
  namespace: kube-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|${kube-vip-namespace}|kube-vip'
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
  name: kube-vip
  namespace: kube-vip
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|porch-system|porch-controllers'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-controllers
  namespace: porch-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|porch-system|porch-fn-runner'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-fn-runner
  namespace: porch-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|porch-system|porch-server'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-server
  namespace: porch-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|tekton-operator|tekton-operator'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-operator
  namespace: tekton-operator
---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ServiceAccount|tekton-pipelines|tekton-dashboard'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|Role|${headscale-namespace}|headscale-bootstrap
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-bootstrap
  namespace: headscale-system
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - create
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
- apiGroups:
  - ""
  resources:
  - pods/exec
  verbs:
  - create
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - get
  - list
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|Role|porch-fn-system|porch-function-executor
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-function-executor
  namespace: porch-fn-system
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - create
  - delete
  - patch
  - get
  - watch
  - list
- apiGroups:
  - ""
  resources:
  - services
  - endpoints
  verbs:
  - create
  - delete
  - get
  - watch
  - list
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - create
  - delete
  - update
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|Role|porch-system|aggregated-apiserver-role
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: aggregated-apiserver-role
  namespace: porch-system
rules:
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  verbs:
  - get
- apiGroups:
  - ""
  resources:
  - serviceaccounts/token
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|Role|tekton-operator|tekton-operator-info
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
  name: tekton-operator-info
  namespace: tekton-operator
rules:
- apiGroups:
  - ""
  resourceNames:
  - tekton-operator-info
  resources:
  - configmaps
  verbs:
  - get
  - describe
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|Role|tekton-pipelines|tekton-dashboard-info
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard-info
  namespace: tekton-pipelines
rules:
- apiGroups:
  - ""
  resourceNames:
  - dashboard-info
  resources:
  - configmaps
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|aggregated-apiserver-clusterrole
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: aggregated-apiserver-clusterrole
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  - secrets
  verbs:
  - get
  - watch
  - list
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - watch
  - list
  - create
  - patch
  - delete
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - validatingadmissionpolicybindings
  - validatingadmissionpolicies
  verbs:
  - get
  - watch
  - list
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - repositories
  - repositories/status
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
- apiGroups:
  - porch.kpt.dev
  resources:
  - packagerevisions
  - packagerevisions/status
  verbs:
  - get
  - list
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagerevs
  - packagerevs/status
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - apiregistration.k8s.io
  resources:
  - apiservices
  verbs:
  - get
- apiGroups:
  - flowcontrol.apiserver.k8s.io
  resources:
  - flowschemas
  - prioritylevelconfigurations
  verbs:
  - get
  - watch
  - list
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
  name: flux-operator-edit
rules:
- apiGroups:
  - fluxcd.controlplane.io
  resources:
  - resourcesets
  - resourcesetinputproviders
  verbs:
  - create
  - delete
  - deletecollection
  - patch
  - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
    rbac.authorization.k8s.io/aggregate-to-view: "true"
  name: flux-operator-view
rules:
- apiGroups:
  - fluxcd.controlplane.io
  resources:
  - resourcesets
  - resourcesetinputproviders
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|headscale-client
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-client
rules:
- apiGroups:
  - ""
  resources:
  - nodes
  verbs:
  - get
  - list
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    kpt.dev/package-layer: networking
    kpt.dev/package-name: kdns
  name: kdns-ingress-reader
rules:
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - services
  - endpoints
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    kpt.dev/package-layer: replication
    kpt.dev/package-name: replicator
  labels:
    app.kubernetes.io/instance: kubernetes-replicator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kubernetes-replicator
    app.kubernetes.io/version: v2.12.2
    helm.sh/chart: kubernetes-replicator-2.12.2
  name: kubernetes-replicator
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - watch
  - list
- apiGroups:
  - ""
  resources:
  - secrets
  - configmaps
  - serviceaccounts
  verbs:
  - get
  - watch
  - list
  - create
  - update
  - patch
  - delete
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - roles
  - rolebindings
  verbs:
  - get
  - watch
  - list
  - create
  - update
  - patch
  - delete
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|porch-controllers
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-controllers
rules:
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|porch-controllers-packagevariants
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-controllers-packagevariants
rules:
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariants
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariants/finalizers
  verbs:
  - update
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariants/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - repositories
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - porch.kpt.dev
  resources:
  - packagerevisionresources
  - packagerevisions
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|porch-controllers-packagevariantsets
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-controllers-packagevariantsets
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - list
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariants
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariantsets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariantsets/finalizers
  verbs:
  - update
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - packagevariantsets/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - config.porch.kpt.dev
  resources:
  - repositories
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|system:kube-vip-role
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
    rbac.authorization.kubernetes.io/autoupdate: "true"
  name: system:kube-vip-role
rules:
- apiGroups:
  - ""
  resources:
  - services
  - services/status
  - nodes
  - endpoints
  verbs:
  - list
  - get
  - watch
  - update
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - list
  - get
  - watch
  - update
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-config-read-role
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-config-read-role
rules:
- apiGroups:
  - operator.tekton.dev
  resources:
  - tektonconfigs
  verbs:
  - get
  - watch
  - list
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-dashboard-backend-edit
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard-backend-edit
rules:
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - dashboard.tekton.dev
  resources:
  - extensions
  verbs:
  - create
  - update
  - delete
  - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-dashboard-backend-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard-backend-view
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - get
  - list
- apiGroups:
  - security.openshift.io
  resources:
  - securitycontextconstraints
  verbs:
  - use
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-dashboard-tenant-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard-tenant-view
rules:
- apiGroups:
  - dashboard.tekton.dev
  resources:
  - extensions
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - events
  - namespaces
  - pods
  - pods/log
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-operator
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-operator
rules:
- apiGroups:
  - ""
  resources:
  - nodes
  verbs:
  - list
- apiGroups:
  - ""
  resources:
  - pods
  - services
  - endpoints
  - persistentvolumeclaims
  - events
  - configmaps
  - secrets
  - pods/log
  - limitranges
  verbs:
  - delete
  - deletecollection
  - create
  - patch
  - get
  - list
  - update
  - watch
  - describe
- apiGroups:
  - extensions
  - apps
  - networking.k8s.io
  resources:
  - ingresses
  - ingresses/status
  verbs:
  - delete
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - ""
  resources:
  - namespaces/finalizers
  verbs:
  - update
- apiGroups:
  - apps
  resources:
  - deployments
  - daemonsets
  - replicasets
  - statefulsets
  - deployments/finalizers
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - monitoring.coreos.com
  resources:
  - servicemonitors
  verbs:
  - get
  - create
  - delete
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - roles
  verbs:
  - get
  - create
  - update
  - delete
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
  - impersonate
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterrolebindings
  - rolebindings
  verbs:
  - get
  - create
  - update
  - delete
  - list
  - watch
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  - customresourcedefinitions/status
  verbs:
  - get
  - create
  - update
  - delete
  - list
  - patch
  - watch
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - build.knative.dev
  resources:
  - builds
  - buildtemplates
  - clusterbuildtemplates
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - extensions
  resources:
  - deployments
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - extensions
  resources:
  - deployments/finalizers
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - operator.tekton.dev
  resources:
  - '*'
  - tektonaddons
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - tekton.dev
  resources:
  - tasks
  - clustertasks
  - taskruns
  - pipelines
  - pipelineruns
  - pipelineresources
  - conditions
  - tasks/status
  - clustertasks/status
  - taskruns/status
  - pipelines/status
  - pipelineruns/status
  - pipelineresources/status
  - taskruns/finalizers
  - pipelineruns/finalizers
  - runs
  - runs/status
  - runs/finalizers
  - customruns
  - customruns/status
  - customruns/finalizers
  - verificationpolicies
  - verificationpolicies/status
  - stepactions
  - stepactions/status
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - triggers.tekton.dev
  - operator.tekton.dev
  resources:
  - '*'
  verbs:
  - add
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - dashboard.tekton.dev
  resources:
  - '*'
  - tektonaddons
  - extensions
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - security.openshift.io
  resources:
  - securitycontextconstraints
  verbs:
  - use
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
- apiGroups:
  - autoscaling
  resources:
  - horizontalpodautoscalers
  verbs:
  - delete
  - deletecollection
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - policy
  resources:
  - poddisruptionbudgets
  verbs:
  - delete
  - deletecollection
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - serving.knative.dev
  resources:
  - '*'
  - '*/status'
  - '*/finalizers'
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
- apiGroups:
  - batch
  resources:
  - cronjobs
  - jobs
  verbs:
  - delete
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - delete
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
- apiGroups:
  - results.tekton.dev
  resources:
  - '*'
  verbs:
  - delete
  - deletecollection
  - create
  - patch
  - get
  - list
  - update
  - watch
- apiGroups:
  - resolution.tekton.dev
  resources:
  - resolutionrequests
  - resolutionrequests/status
  verbs:
  - get
  - list
  - watch
  - create
  - delete
  - update
  - patch
- apiGroups:
  - openshift-pipelines.org
  resources:
  - approvaltasks
  - approvaltasks/status
  verbs:
  - add
  - get
  - list
  - create
  - update
  - delete
  - deletecollection
  - patch
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRole|default|tekton-result-read-role
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-result-read-role
rules:
- apiGroups:
  - operator.tekton.dev
  resources:
  - tektonresults
  verbs:
  - get
  - watch
  - list
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|${headscale-namespace}|headscale-bootstrap
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-bootstrap
  namespace: headscale-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: headscale-bootstrap
subjects:
- kind: ServiceAccount
  name: headscale-bootstrap
  namespace: headscale-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|kube-system|porch-auth-reader
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-auth-reader
  namespace: kube-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: extension-apiserver-authentication-reader
subjects:
- kind: ServiceAccount
  name: porch-server
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|porch-fn-system|porch-function-executor
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-function-executor
  namespace: porch-fn-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: porch-function-executor
subjects:
- kind: ServiceAccount
  name: porch-fn-runner
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|porch-system|sample-apiserver-rolebinding
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: sample-apiserver-rolebinding
  namespace: porch-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: aggregated-apiserver-role
subjects:
- kind: ServiceAccount
  name: porch-server
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|tekton-operator|tekton-operator-info
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
  name: tekton-operator-info
  namespace: tekton-operator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tekton-operator-info
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|RoleBinding|tekton-pipelines|tekton-dashboard-info
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: tekton-dashboard-info
  namespace: tekton-pipelines
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tekton-dashboard-info
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    kpt.dev/package-layer: networking
    kpt.dev/package-name: kdns
  name: kdns-ingress-reader-binding
  namespace: kdns-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kdns-ingress-reader
subjects:
- kind: ServiceAccount
  name: kdns
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|envoy-gateway-installer
    kpt.dev/package-layer: networking
    kpt.dev/package-name: envoy-gateway
  name: envoy-gateway-installer
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: envoy-gateway-installer
  namespace: envoy-gateway-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: flux-operator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: flux-operator
  namespace: flux-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|headscale-client
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-client
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: headscale-client
subjects:
- kind: ServiceAccount
  name: headscale-client
  namespace: headscale-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    kpt.dev/package-layer: replication
    kpt.dev/package-name: replicator
  labels:
    app.kubernetes.io/instance: kubernetes-replicator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kubernetes-replicator
    app.kubernetes.io/version: v2.12.2
    helm.sh/chart: kubernetes-replicator-2.12.2
  name: kubernetes-replicator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubernetes-replicator
subjects:
- kind: ServiceAccount
  name: kubernetes-replicator
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|porch-system:porch-controllers-packagevariants
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-system:porch-controllers-packagevariants
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: porch-controllers-packagevariants
subjects:
- kind: ServiceAccount
  name: porch-controllers
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|porch-system:porch-controllers-packagevariantsets
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-system:porch-controllers-packagevariantsets
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: porch-controllers-packagevariantsets
subjects:
- kind: ServiceAccount
  name: porch-controllers
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|porch:system:auth-delegator
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch:system:auth-delegator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: porch-server
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|sample-apiserver-clusterrolebinding
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: sample-apiserver-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: aggregated-apiserver-clusterrole
subjects:
- kind: ServiceAccount
  name: porch-server
  namespace: porch-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|system:kube-vip-binding
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
  name: system:kube-vip-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:kube-vip-role
subjects:
- kind: ServiceAccount
  name: kube-vip
  namespace: kube-vip
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-config-read-rolebinding
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-config-read-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-config-read-role
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-backend-edit
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-backend-edit
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-dashboard-backend-edit
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-backend-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-backend-view
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-dashboard-backend-view
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-pipelines-edit
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-pipelines-edit
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-aggregate-edit
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-pipelines-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-pipelines-view
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-aggregate-view
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-tenant-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-tenant-view
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-dashboard-tenant-view
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-triggers-edit
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-triggers-edit
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-triggers-aggregate-edit
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-dashboard-triggers-view
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
  name: tekton-dashboard-triggers-view
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-triggers-aggregate-view
subjects:
- kind: ServiceAccount
  name: tekton-dashboard
  namespace: tekton-pipelines
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-operator
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-operator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-operator
subjects:
- kind: ServiceAccount
  name: tekton-operator
  namespace: tekton-operator
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: rbac.authorization.k8s.io|ClusterRoleBinding|default|tekton-result-read-rolebinding
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: tekton-result-read-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-result-read-role
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated
---
apiVersion: v1
data:
  acl.json: |
    {
      "groups": {
        "group:admin": []
      },
      "tagOwners": {
        "tag:darwin": ["group:admin"],
        "tag:nixos": ["group:admin"],
        "tag:rke2": ["group:admin"]
      },
      "acls": [
        {
          "action": "accept",
          "src": ["*"],
          "dst": ["*:*"]
        }
      ],
      "ssh": [
        {
          "action": "accept",
          "src": ["group:admin", "tag:darwin", "tag:nixos"],
          "dst": ["*"],
          "users": ["autogroup:nonroot", "root"]
        }
      ]
    }
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|${headscale-namespace}|headscale-acl'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-acl
  namespace: headscale-system
---
apiVersion: v1
data:
  config.yaml: |
    server_url: http://192.168.1.193:8080 # kpt-set: http://${cluster-lan-headscale-inetaddr}:8080
    listen_addr: 0.0.0.0:8080
    metrics_listen_addr: 0.0.0.0:9090
    grpc_listen_addr: 0.0.0.0:50443
    grpc_allow_insecure: true

    tls:
      letsencrypt_hostname: ""
      letsencrypt_cache_dir: ""
      letsencrypt_challenge_type: ""
      cert_path: ""
      key_path: ""

    private_key_path: /var/lib/headscale/private.key
    noise:
      private_key_path: /var/lib/headscale/noise_private.key

    prefixes:
      v4: 100.64.0.0/10
      v6: fd7a:115c:a1e0::/48

    derp:
      server:
        enabled: false
      urls: []
      paths:
        - /etc/headscale/derp.yaml
      auto_update_enabled: false
      update_frequency: 24h

    disable_check_updates: true
    ephemeral_node_inactivity_timeout: 30m
    database:
      type: sqlite
      sqlite:
        path: /var/lib/headscale/db.sqlite

    policy:
      mode: file
      path: /etc/headscale/acl.json

    dns:
      base_domain: lan
      nameservers:
        global:
          - 192.168.1.254
          - 1.1.1.1
          - 8.8.8.8
      magic_dns: true

    log:
      format: text
      level: info
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|${headscale-namespace}|headscale-config'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-config
  namespace: headscale-system
---
apiVersion: v1
data:
  derp.yaml: |
    regions:
      900:
        regionid: 900
        regioncode: local
        regionname: Local LAN
        nodes: []
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|${headscale-namespace}|headscale-derp'
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-derp
  namespace: headscale-system
---
apiVersion: v1
data:
  pod-cache-config.yaml: |
    ghcr.io/kptdev/krm-functions-catalog/apply-replacements:v0.1.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/create-setters:v0.1.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/ensure-name-substring:v0.2.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/gatekeeper:v0.2.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/kubeconform:v0.1.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/search-replace:v0.2.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-annotations:v0.1.4: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-enforcement-action:v0.1.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-image:v0.1.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-labels:v0.1.5: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-namespace:v0.4.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/starlark:v0.4.3: 30m
    ghcr.io/kptdev/krm-functions-catalog/upsert-resource:v0.2.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/enable-gcp-services:v0.1.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/export-terraform:v0.1.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/generate-folders:v0.1.1: 30m
    ghcr.io/kptdev/krm-functions-catalog/remove-local-config-resources:v0.1.0: 30m
    ghcr.io/kptdev/krm-functions-catalog/set-project-id:v0.2.0: 30m
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|porch-system|pod-cache-config'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: pod-cache-config
  namespace: porch-system
---
apiVersion: v1
data:
  _example: |
    ################################
    #                              #
    #    EXAMPLE CONFIGURATION     #
    #                              #
    ################################

    # This block is not actually functional configuration,
    # but serves to illustrate the available configuration
    # options and document them in a way that is accessible
    # to users that `kubectl edit` this config map.
    #
    # These sample configuration options may be copied out of
    # this example block and unindented to be in the data block
    # to actually change the configuration.

    # Common configuration for all Knative codebase
    zap-logger-config: |
      {
        "level": "info",
        "development": false,
        "outputPaths": ["stdout"],
        "errorOutputPaths": ["stderr"],
        "encoding": "json",
        "encoderConfig": {
          "timeKey": "ts",
          "levelKey": "level",
          "nameKey": "logger",
          "callerKey": "caller",
          "messageKey": "msg",
          "stacktraceKey": "stacktrace",
          "lineEnding": "",
          "levelEncoder": "",
          "timeEncoder": "iso8601",
          "durationEncoder": "",
          "callerEncoder": ""
        }
      }
  loglevel.tekton-operator-cluster-operations: info
  loglevel.tekton-operator-lifecycle: info
  loglevel.tekton-operator-webhook: info
  zap-logger-config: |
    {
      "level": "info",
      "development": false,
      "sampling": {
        "initial": 100,
        "thereafter": 100
      },
      "outputPaths": ["stdout"],
      "errorOutputPaths": ["stderr"],
      "encoding": "json",
      "encoderConfig": {
        "timeKey": "timestamp",
        "levelKey": "level",
        "nameKey": "logger",
        "callerKey": "caller",
        "messageKey": "msg",
        "stacktraceKey": "stacktrace",
        "lineEnding": "",
        "levelEncoder": "",
        "timeEncoder": "iso8601",
        "durationEncoder": "",
        "callerEncoder": ""
      }
    }
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|config-logging'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
  name: config-logging
  namespace: tekton-operator
---
apiVersion: v1
data:
  AUTOINSTALL_COMPONENTS: "true"
  DEFAULT_TARGET_NAMESPACE: tekton-pipelines
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|tekton-config-defaults'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
  name: tekton-config-defaults
  namespace: tekton-operator
---
apiVersion: v1
data:
  _example: |
    ################################
    #                              #
    #    EXAMPLE CONFIGURATION     #
    #                              #
    ################################
    # This block is not actually functional configuration,
    # but serves to illustrate the available configuration
    # options and document them in a way that is accessible
    # to users that `kubectl edit` this config map.
    #
    # These sample configuration options may be copied out of
    # this example block and unindented to be in the data block
    # to actually change the configuration.
    # metrics.backend-destination field specifies the system metrics destination.
    # It supports either prometheus (the default) or stackdriver.
    # Note: Using Stackdriver will incur additional charges.
    metrics.backend-destination: prometheus
    # metrics.stackdriver-project-id field specifies the Stackdriver project ID. This
    # field is optional. When running on GCE, application default credentials will be
    # used and metrics will be sent to the cluster's project if this field is
    # not provided.
    metrics.stackdriver-project-id: "<your stackdriver project id>"
    # metrics.allow-stackdriver-custom-metrics indicates whether it is allowed
    # to send metrics to Stackdriver using "global" resource type and custom
    # metric type. Setting this flag to "true" could cause extra Stackdriver
    # charge.  If metrics.backend-destination is not Stackdriver, this is
    # ignored.
    metrics.allow-stackdriver-custom-metrics: "false"
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|tekton-config-observability'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
  name: tekton-config-observability
  namespace: tekton-operator
---
apiVersion: v1
data:
  _example: |
    ################################
    #                              #
    #    EXAMPLE CONFIGURATION     #
    #                              #
    ################################
    # This block is not actually functional configuration,
    # but serves to illustrate the available configuration
    # options and document them in a way that is accessible
    # to users that `kubectl edit` this config map.
    #
    # These sample configuration options may be copied out of
    # this example block and unindented to be in the data block
    # to actually change the configuration.
    # lease-duration is how long non-leaders will wait to try to acquire the
    # lock; 15 seconds is the value used by core kubernetes controllers.
    lease-duration: "60s"
    # renew-deadline is how long a leader will try to renew the lease before
    # giving up; 10 seconds is the value used by core kubernetes controllers.
    renew-deadline: "40s"
    # retry-period is how long the leader election client waits between tries of
    # actions; 2 seconds is the value used by core kubernetes controllers.
    retry-period: "10s"
    # buckets is the number of buckets used to partition key space of each
    # Reconciler. If this number is M and the replica number of the controller
    # is N, the N replicas will compete for the M buckets. The owner of a
    # bucket will take care of the reconciling for the keys partitioned into
    # that bucket.
    buckets: "1"
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|tekton-operator-controller-config-leader-election'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
    operator.tekton.dev/release: v0.78.1
  name: tekton-operator-controller-config-leader-election
  namespace: tekton-operator
---
apiVersion: v1
data:
  version: v0.78.1
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|tekton-operator-info'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
  name: tekton-operator-info
  namespace: tekton-operator
---
apiVersion: v1
data:
  _example: |
    ################################
    #                              #
    #    EXAMPLE CONFIGURATION     #
    #                              #
    ################################
    # This block is not actually functional configuration,
    # but serves to illustrate the available configuration
    # options and document them in a way that is accessible
    # to users that `kubectl edit` this config map.
    #
    # These sample configuration options may be copied out of
    # this example block and unindented to be in the data block
    # to actually change the configuration.
    # lease-duration is how long non-leaders will wait to try to acquire the
    # lock; 15 seconds is the value used by core kubernetes controllers.
    lease-duration: "60s"
    # renew-deadline is how long a leader will try to renew the lease before
    # giving up; 10 seconds is the value used by core kubernetes controllers.
    renew-deadline: "40s"
    # retry-period is how long the leader election client waits between tries of
    # actions; 2 seconds is the value used by core kubernetes controllers.
    retry-period: "10s"
    # buckets is the number of buckets used to partition key space of each
    # Reconciler. If this number is M and the replica number of the controller
    # is N, the N replicas will compete for the M buckets. The owner of a
    # bucket will take care of the reconciling for the keys partitioned into
    # that bucket.
    buckets: "1"
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-operator|tekton-operator-webhook-config-leader-election'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app.kubernetes.io/instance: default
    operator.tekton.dev/release: devel
  name: tekton-operator-webhook-config-leader-election
  namespace: tekton-operator
---
apiVersion: v1
data:
  version: v0.63.1
kind: ConfigMap
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|ConfigMap|tekton-pipelines|dashboard-info'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app.kubernetes.io/instance: default
    app.kubernetes.io/part-of: tekton-dashboard
  name: dashboard-info
  namespace: tekton-pipelines
---
apiVersion: v1
kind: Secret
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Secret|tekton-operator|tekton-operator-webhook-certs'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app: tekton-operator
    name: tekton-operator-webhook
  name: tekton-operator-webhook-certs
  namespace: tekton-operator
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: flux-operator
  namespace: flux-system
spec:
  ports:
  - name: http
    port: 8080
    protocol: TCP
    targetPort: http-metrics
  selector:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/name: flux-operator
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|${headscale-namespace}|headscale'
    io.cilium/lb-ipam-pool: 192.168.1.65
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
    tailscale.com/expose: "true"
    tailscale.com/hostname: alcide-headscale
  labels:
    app: headscale
    io.cilium/lb-ipam-pool: home-lan
  name: headscale
  namespace: headscale-system
spec:
  ports:
  - name: http
    port: 8080
    protocol: TCP
    targetPort: 8080
  - name: metrics
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app: headscale
  type: LoadBalancer
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|kube-system|control-plane-nodeport'
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
  labels:
    backup-service: "true"
  name: control-plane-nodeport
  namespace: kube-system
spec:
  externalTrafficPolicy: Cluster
  ports:
  - name: kube-apiserver
    nodePort: 30443
    port: 6443
    protocol: TCP
    targetPort: 6443
  selector:
    component: kube-apiserver
    tier: control-plane
  type: NodePort
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|porch-system|api'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: api
  namespace: porch-system
spec:
  ports:
  - name: api
    port: 443
    protocol: TCP
    targetPort: 4443
  - name: webhooks
    port: 8443
    protocol: TCP
    targetPort: 8443
  selector:
    app: porch-server
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|porch-system|function-runner'
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: function-runner
  namespace: porch-system
spec:
  ports:
  - port: 9445
    protocol: TCP
    targetPort: 9445
  selector:
    app: function-runner
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|tekton-operator|tekton-operator'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app: tekton-pipelines-controller
    version: v0.78.1
  name: tekton-operator
  namespace: tekton-operator
spec:
  ports:
  - name: http-metrics
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app: tekton-operator
    name: tekton-operator
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|tekton-operator|tekton-operator-webhook'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    app: tekton-operator
    name: tekton-operator-webhook
    operator.tekton.dev/release: devel
    version: devel
  name: tekton-operator-webhook
  namespace: tekton-operator
spec:
  ports:
  - name: https-webhook
    port: 443
    targetPort: 8443
  selector:
    app: tekton-operator
    name: tekton-operator-webhook
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: '|Service|tekton-pipelines|tekton-dashboard'
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app: tekton-dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: tekton-dashboard
    app.kubernetes.io/version: v0.63.1
    dashboard.tekton.dev/release: v0.63.1
    version: v0.63.1
  name: tekton-dashboard
  namespace: tekton-pipelines
spec:
  ports:
  - name: http
    port: 9097
    protocol: TCP
    targetPort: 9097
  selector:
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: tekton-dashboard
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-operator
  labels:
    app.kubernetes.io/instance: flux-operator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-operator
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-operator-0.36.0
  name: flux-operator
  namespace: flux-system
spec:
  selector:
    matchLabels:
      app.kubernetes.io/instance: flux-operator
      app.kubernetes.io/name: flux-operator
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: gitops
        kpt.dev/package-name: flux-operator
        prometheus.io/path: /metrics
        prometheus.io/port: "8080"
        prometheus.io/scrape: "true"
      labels:
        app.kubernetes.io/instance: flux-operator
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: flux-operator
        app.kubernetes.io/version: v0.36.0
        helm.sh/chart: flux-operator-0.36.0
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/os
                operator: In
                values:
                - linux
      containers:
      - args:
        - --log-level=info
        env:
        - name: RUNTIME_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: REPORTING_INTERVAL
          value: 5m
        image: ghcr.io/controlplaneio-fluxcd/flux-operator:v0.36.0
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8081
          initialDelaySeconds: 15
          periodSeconds: 20
        name: manager
        ports:
        - containerPort: 8080
          name: http-metrics
          protocol: TCP
        - containerPort: 8081
          name: http
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /readyz
            port: 8081
          initialDelaySeconds: 5
          periodSeconds: 10
        resources:
          limits:
            cpu: 2000m
            memory: 1Gi
          requests:
            cpu: 100m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        volumeMounts:
        - mountPath: /tmp
          name: temp
      priorityClassName: system-cluster-critical
      serviceAccountName: flux-operator
      volumes:
      - emptyDir: {}
        name: temp
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|${headscale-namespace}|headscale
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  labels:
    app: headscale
  name: headscale
  namespace: headscale-system
spec:
  replicas: 1
  selector:
    matchLabels:
      app: headscale
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: mesh
        kpt.dev/package-name: headscale
      labels:
        app: headscale
    spec:
      automountServiceAccountToken: false
      containers:
      - command:
        - headscale
        - serve
        image: headscale/headscale:0.27.0
        livenessProbe:
          httpGet:
            path: /health
            port: http
          initialDelaySeconds: 30
          periodSeconds: 10
        name: headscale
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        - containerPort: 9090
          name: metrics
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /health
            port: http
          initialDelaySeconds: 10
          periodSeconds: 5
        resources:
          limits:
            cpu: 500m
            memory: 512Mi
          requests:
            cpu: 100m
            memory: 128Mi
        volumeMounts:
        - mountPath: /etc/headscale/config.yaml
          name: config
          subPath: config.yaml
        - mountPath: /etc/headscale/acl.json
          name: acl
          subPath: acl.json
        - mountPath: /etc/headscale/derp.yaml
          name: derp
          subPath: derp.yaml
        - mountPath: /var/lib/headscale
          name: data
        - mountPath: /var/run/headscale
          name: run
      nodeSelector:
        node-role.kubernetes.io/control-plane: "true"
      volumes:
      - configMap:
          name: headscale-config
        name: config
      - configMap:
          name: headscale-acl
        name: acl
      - configMap:
          name: headscale-derp
        name: derp
      - emptyDir: {}
        name: data
      - emptyDir: {}
        name: run
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|${headscale-namespace}|headscale-gateway
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  labels:
    app: headscale-gateway
  name: headscale-gateway
  namespace: headscale-system
spec:
  replicas: 1
  selector:
    matchLabels:
      app: headscale-gateway
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: mesh
        kpt.dev/package-name: headscale
      labels:
        app: headscale-gateway
    spec:
      automountServiceAccountToken: false
      containers:
      - command:
        - sh
        - -c
        - |
          set -e
          sysctl -w net.ipv4.ip_forward=1
          sysctl -w net.ipv6.conf.all.forwarding=1 || true

          echo "Starting tailscaled router..."
          tailscaled --state=/var/lib/tailscale/tailscaled.state --socket=/var/run/tailscale/tailscaled.sock &
          TAILSCALED_PID=$$!

          until [ -S /var/run/tailscale/tailscaled.sock ]; do sleep 1; done

          tailscale up \
            --login-server=$$HEADSCALE_URL \
            --authkey=file:/var/secrets/authkey \
            --hostname=$${DARWIN_HOST}-gateway \
            --advertise-routes=$${VIP_NETWORK_CIDR} \
            --accept-dns=false \
            --ssh \
            --reset

          tailscale set --advertise-routes=$${VIP_NETWORK_CIDR}

          wait $$TAILSCALED_PID
        env:
        - name: DARWIN_HOST
          value: alcide
        - name: VIP_NETWORK_CIDR
          value: 10.80.15.0/24
        - name: TS_AUTHKEY
          valueFrom:
            secretKeyRef:
              key: authkey
              name: headscale-client-auth
        - name: HEADSCALE_URL
          value: http://headscale.headscale-system.svc.cluster.local:8080
        image: tailscale/tailscale:v1.76.6
        name: tailscale-gateway
        resources:
          limits:
            cpu: 200m
            ephemeral-storage: 500Mi
            memory: 256Mi
          requests:
            cpu: 50m
            ephemeral-storage: 100Mi
            memory: 64Mi
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
            - NET_RAW
          privileged: true
        volumeMounts:
        - mountPath: /dev/net/tun
          name: dev-net-tun
        - mountPath: /var/lib/tailscale
          name: tailscale-state
        - mountPath: /var/run/tailscale
          name: tailscale-socket
        - mountPath: /var/secrets
          name: authkey
          readOnly: true
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true
      nodeSelector:
        node-role.kubernetes.io/control-plane: "true"
      serviceAccountName: headscale-gateway
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      volumes:
      - hostPath:
          path: /dev/net/tun
          type: CharDevice
        name: dev-net-tun
      - hostPath:
          path: /var/lib/tailscale
          type: DirectoryOrCreate
        name: tailscale-state
      - emptyDir: {}
        name: tailscale-socket
      - name: authkey
        secret:
          items:
          - key: authkey
            path: authkey
          secretName: headscale-client-auth
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|default|kdns
    kpt.dev/package-layer: networking
    kpt.dev/package-name: kdns
  labels:
    app.kubernetes.io/instance: kdns
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kdns
    helm.sh/chart: kdns-0.2.3
  name: kdns
  namespace: kube-system
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/instance: kdns
      app.kubernetes.io/name: kdns
  template:
    metadata:
      annotations:
        debug.kdns.lab42/enabled: "false"
        kpt.dev/package-layer: networking
        kpt.dev/package-name: kdns
      labels:
        app.kubernetes.io/instance: kdns
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kdns
        helm.sh/chart: kdns-0.2.3
    spec:
      containers:
      - args:
        - |
          set -euo pipefail
          enabled="${KDNS_DEBUG_ENABLED:-}"
          if [ "$enabled" != "true" ]; then
            echo "[kdns-dlv] debug disabled (set annotation debug.kdns.lab42/enabled=true to enable); sleeping"
            sleep 3650d
          fi
          apk add --no-cache wget ca-certificates >/dev/null
          arch=$(uname -m)
          case "$arch" in
            x86_64) arch=amd64 ;;
            aarch64) arch=arm64 ;;
          esac
          dlv_version="1.22.1"
          url="https://github.com/go-delve/delve/releases/download/v${dlv_version}/dlv_${dlv_version}_linux_${arch}.tar.gz"
          echo "[kdns-dlv] fetching dlv ${dlv_version} from ${url}"
          wget -qO /tmp/dlv.tgz "$url"
          tar -xzf /tmp/dlv.tgz -C /tmp
          chmod +x /tmp/dlv
          target_pid=$(pidof kdns || true)
          if [ -z "$target_pid" ]; then
            echo "[kdns-dlv] kdns process not found; sleeping"
            sleep 1d
          fi
          echo "[kdns-dlv] starting delve headless on :${KDNS_DEBUG_PORT} attaching to pid ${target_pid}"
          exec /tmp/dlv attach "$target_pid" --headless --listen=":${KDNS_DEBUG_PORT}" --api-version=2 --accept-multiclient --log --continue
        command:
        - /bin/sh
        - -c
        env:
        - name: KDNS_DEBUG_ENABLED
          valueFrom:
            fieldRef:
              fieldPath: metadata.annotations['debug.kdns.lab42/enabled']
        - name: KDNS_DEBUG_PORT
          value: "40000"
        image: alpine:3.19
        imagePullPolicy: IfNotPresent
        name: kdns-dlv
        ports:
        - containerPort: 40000
          name: dlv
          protocol: TCP
        resources:
          limits:
            cpu: 50m
            memory: 128Mi
          requests:
            cpu: 10m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            add:
            - SYS_PTRACE
            drop:
            - ALL
          readOnlyRootFilesystem: false
          runAsNonRoot: false
          runAsUser: 0
      - env:
        - name: KUBERNETES_SERVICE_HOST
          value: 10.80.8.10
        - name: KUBERNETES_SERVICE_PORT
          value: "6443"
        image: ghcr.io/lab42/kdns:v0.2.9
        imagePullPolicy: IfNotPresent
        livenessProbe: null
        name: kdns
        ports:
        - containerPort: 5353
          hostPort: 5353
          name: http
          protocol: TCP
        readinessProbe: null
        resources:
          limits:
            cpu: 200m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          runAsUser: 1000
      dnsPolicy: Default
      hostNetwork: true
      securityContext: {}
      serviceAccountName: kdns
      shareProcessNamespace: true
      tolerations:
      - operator: Exists
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kpt.dev/package-layer: replication
    kpt.dev/package-name: replicator
  labels:
    app.kubernetes.io/instance: kubernetes-replicator
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kubernetes-replicator
    app.kubernetes.io/version: v2.12.2
    helm.sh/chart: kubernetes-replicator-2.12.2
  name: kubernetes-replicator
  namespace: kube-system
spec:
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: kubernetes-replicator
      app.kubernetes.io/name: kubernetes-replicator
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: replication
        kpt.dev/package-name: replicator
      labels:
        app.kubernetes.io/instance: kubernetes-replicator
        app.kubernetes.io/name: kubernetes-replicator
    spec:
      automountServiceAccountToken: true
      containers:
      - args:
        - -replicate-secrets=true
        - -replicate-configmaps=true
        - -replicate-roles=true
        - -replicate-role-bindings=true
        - -replicate-service-accounts=true
        image: quay.io/mittwald/kubernetes-replicator:v2.12.2
        imagePullPolicy: Always
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: health
          initialDelaySeconds: 60
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        name: kubernetes-replicator
        ports:
        - containerPort: 9102
          name: health
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /readyz
            port: health
          initialDelaySeconds: 60
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        resources: {}
        securityContext: {}
      securityContext: {}
      serviceAccountName: kubernetes-replicator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|porch-system|function-runner
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: function-runner
  namespace: porch-system
spec:
  replicas: 2
  selector:
    matchLabels:
      app: function-runner
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: gitops
        kpt.dev/package-name: porch
      labels:
        app: function-runner
    spec:
      containers:
      - command:
        - /server
        - --config=/config.yaml
        - --functions=/functions
        - --pod-namespace=porch-fn-system
        - --max-request-body-size=6291456
        - --warm-up-pod-cache=true
        env:
        - name: WRAPPER_SERVER_IMAGE
          value: ghcr.io/nxmatic/porch-wrapper-server:v1.5.5
        image: ghcr.io/nxmatic/porch-function-runner:v1.5.5
        imagePullPolicy: IfNotPresent
        name: function-runner
        ports:
        - containerPort: 9445
        readinessProbe:
          exec:
            command:
            - /grpc-health-probe
            - -addr
            - localhost:9445
        resources:
          requests:
            cpu: 125m
            memory: 64Mi
        volumeMounts:
        - mountPath: /pod-cache-config
          name: pod-cache-config-volume
      serviceAccountName: porch-fn-runner
      volumes:
      - configMap:
          name: pod-cache-config
        name: pod-cache-config-volume
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|porch-system|porch-controllers
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  labels:
    k8s-app: porch-controllers
  name: porch-controllers
  namespace: porch-system
spec:
  replicas: 1
  selector:
    matchLabels:
      k8s-app: porch-controllers
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: gitops
        kpt.dev/package-name: porch
      labels:
        k8s-app: porch-controllers
    spec:
      containers:
      - env:
        - name: ENABLE_PACKAGEVARIANTS
          value: "true"
        - name: ENABLE_PACKAGEVARIANTSETS
          value: "true"
        image: ghcr.io/nxmatic/porch-controllers:v1.5.5
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 8081
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 30
          successThreshold: 1
          timeoutSeconds: 5
        name: porch-controllers
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /readyz
            port: 8081
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 3
      serviceAccountName: porch-controllers
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|porch-system|porch-server
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: porch-server
  namespace: porch-system
spec:
  replicas: 1
  selector:
    matchLabels:
      app: porch-server
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: gitops
        kpt.dev/package-name: porch
      labels:
        app: porch-server
    spec:
      containers:
      - args:
        - --function-runner=function-runner:9445
        - --cache-directory=/cache
        - --cert-dir=/tmp/certs
        - --secure-port=4443
        - --repo-sync-frequency=3m
        - --repo-operation-retry-attempts=3
        - --max-request-body-size=6291456
        env:
        - name: OTEL_SERVICE_NAME
          value: porch-server
        - name: CERT_STORAGE_DIR
          value: /etc/webhook/certs
        - name: GOOGLE_API_GO_EXPERIMENTAL_DISABLE_NEW_AUTH_LIB
          value: "true"
        image: ghcr.io/nxmatic/porch-server:v1.5.5
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 4443
            scheme: HTTPS
          initialDelaySeconds: 30
          periodSeconds: 30
          successThreshold: 1
          timeoutSeconds: 5
        name: porch-server
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /readyz
            port: 4443
            scheme: HTTPS
          initialDelaySeconds: 5
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 3
        resources:
          limits:
            memory: 512Mi
          requests:
            cpu: 250m
            memory: 256Mi
        securityContext:
          runAsGroup: 65532
          runAsNonRoot: true
          runAsUser: 65532
        volumeMounts:
        - mountPath: /usr/bin/git
          name: git-bin
          subPath: git
        - mountPath: /usr/bin/git-remote-https
          name: git-bin
          subPath: git-remote-https
        - mountPath: /cache
          name: cache-volume
        - mountPath: /etc/webhook/certs
          name: webhook-certs
        - mountPath: /tmp/certs
          name: api-server-certs
      initContainers:
      - command:
        - sh
        - -c
        - |
          apk add --no-cache git ca-certificates openssh-client
          cp -r /usr/bin/git* /git-bin/
          cp /usr/bin/ssh* /git-bin/ || true
        image: alpine:latest
        name: install-git
        securityContext:
          runAsUser: 0
        volumeMounts:
        - mountPath: /git-bin
          name: git-bin
      serviceAccountName: porch-server
      volumes:
      - emptyDir: {}
        name: git-bin
      - emptyDir: {}
        name: cache-volume
      - emptyDir: {}
        name: webhook-certs
      - emptyDir: {}
        name: api-server-certs
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|tekton-operator|tekton-operator
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tekton-operator
  namespace: tekton-operator
spec:
  replicas: 1
  selector:
    matchLabels:
      name: tekton-operator
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: cicd
        kpt.dev/package-name: tekton-pipelines
      labels:
        app: tekton-operator
        name: tekton-operator
    spec:
      containers:
      - args:
        - -controllers
        - tektonconfig,tektonpipeline,tektontrigger,tektonhub,tektonchain,tektonresult,tektondashboard,manualapprovalgate,tektonpruner
        - -unique-process-name
        - tekton-operator-lifecycle
        env:
        - name: KUBERNETES_MIN_VERSION
          value: v1.0.0
        - name: SYSTEM_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: OPERATOR_NAME
          value: tekton-operator
        - name: IMAGE_PIPELINES_PROXY
          value: ghcr.io/tektoncd/operator/proxy-webhook-f6167da7bc41b96a27c5529f850e63d1:v0.78.1@sha256:cdbd01b0305088ef9e741b28347fa87de6663e043815ef8c94f6911a44d2a6fe
        - name: IMAGE_JOB_PRUNER_TKN
          value: ghcr.io/tektoncd/plumbing/tkn@sha256:233de6c8b8583a34c2379fa98d42dba739146c9336e8d41b66030484357481ed
        - name: METRICS_DOMAIN
          value: tekton.dev/operator
        - name: VERSION
          value: v0.78.1
        - name: CONFIG_OBSERVABILITY_NAME
          value: tekton-config-observability
        - name: CONFIG_LEADERELECTION_NAME
          value: tekton-operator-controller-config-leader-election
        - name: AUTOINSTALL_COMPONENTS
          valueFrom:
            configMapKeyRef:
              key: AUTOINSTALL_COMPONENTS
              name: tekton-config-defaults
        - name: DEFAULT_TARGET_NAMESPACE
          valueFrom:
            configMapKeyRef:
              key: DEFAULT_TARGET_NAMESPACE
              name: tekton-config-defaults
        image: ghcr.io/tektoncd/operator/operator-303303c315a48490ba6517859ef65b77:v0.78.1@sha256:04d34b885c168560b4562ff60918ec7aa53c6443ffa694a0c95a7c27677c0e16
        imagePullPolicy: IfNotPresent
        name: tekton-operator-lifecycle
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          seccompProfile:
            type: RuntimeDefault
      - args:
        - -controllers
        - tektoninstallerset
        - -unique-process-name
        - tekton-operator-cluster-operations
        env:
        - name: KUBERNETES_MIN_VERSION
          value: v1.0.0
        - name: SYSTEM_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: OPERATOR_NAME
          value: tekton-operator
        - name: PROFILING_PORT
          value: "9009"
        - name: VERSION
          value: v0.78.1
        - name: METRICS_DOMAIN
          value: tekton.dev/operator
        - name: CONFIG_LEADERELECTION_NAME
          value: tekton-operator-controller-config-leader-election
        image: ghcr.io/tektoncd/operator/operator-303303c315a48490ba6517859ef65b77:v0.78.1@sha256:04d34b885c168560b4562ff60918ec7aa53c6443ffa694a0c95a7c27677c0e16
        imagePullPolicy: IfNotPresent
        name: tekton-operator-cluster-operations
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          seccompProfile:
            type: RuntimeDefault
      serviceAccountName: tekton-operator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|tekton-operator|tekton-operator-webhook
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  labels:
    operator.tekton.dev/release: v0.78.1
    version: v0.78.1
  name: tekton-operator-webhook
  namespace: tekton-operator
spec:
  replicas: 1
  selector:
    matchLabels:
      name: tekton-operator-webhook
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: cicd
        kpt.dev/package-name: tekton-pipelines
      labels:
        app: tekton-operator
        name: tekton-operator-webhook
    spec:
      containers:
      - env:
        - name: KUBERNETES_MIN_VERSION
          value: v1.0.0
        - name: SYSTEM_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: WEBHOOK_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: CONFIG_LOGGING_NAME
          value: config-logging
        - name: CONFIG_LEADERELECTION_NAME
          value: tekton-operator-webhook-config-leader-election
        - name: WEBHOOK_SERVICE_NAME
          value: tekton-operator-webhook
        - name: WEBHOOK_SECRET_NAME
          value: tekton-operator-webhook-certs
        - name: METRICS_DOMAIN
          value: tekton.dev/operator
        image: ghcr.io/tektoncd/operator/webhook-f2bb711aa8f0c0892856a4cbf6d9ddd8:v0.78.1@sha256:03071f1dee8f17cec9a46507ddfca468c953410e98aa5ed15888e2f1992ea0a5
        name: tekton-operator-webhook
        ports:
        - containerPort: 8443
          name: https-webhook
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          seccompProfile:
            type: RuntimeDefault
      serviceAccountName: tekton-operator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|Deployment|tekton-pipelines|tekton-dashboard
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  labels:
    app: tekton-dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/instance: default
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: tekton-dashboard
    app.kubernetes.io/version: v0.63.1
    dashboard.tekton.dev/release: v0.63.1
    version: v0.63.1
  name: tekton-dashboard
  namespace: tekton-pipelines
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/component: dashboard
      app.kubernetes.io/instance: default
      app.kubernetes.io/name: dashboard
      app.kubernetes.io/part-of: tekton-dashboard
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: cicd
        kpt.dev/package-name: tekton-dashboard
      labels:
        app: tekton-dashboard
        app.kubernetes.io/component: dashboard
        app.kubernetes.io/instance: default
        app.kubernetes.io/name: dashboard
        app.kubernetes.io/part-of: tekton-dashboard
        app.kubernetes.io/version: v0.63.1
      name: tekton-dashboard
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/os
                operator: NotIn
                values:
                - windows
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app.kubernetes.io/component: dashboard
                  app.kubernetes.io/instance: default
                  app.kubernetes.io/name: dashboard
                  app.kubernetes.io/part-of: tekton-dashboard
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - --default-namespace=
        - --external-logs=
        - --log-format=json
        - --log-level=info
        - --logout-url=
        - --namespaces=
        - --pipelines-namespace=tekton-pipelines
        - --port=9097
        - --read-only=false
        - --stream-logs=true
        - --triggers-namespace=tekton-pipelines
        env:
        - name: INSTALLED_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        image: ghcr.io/tektoncd/dashboard/dashboard-9623576a202fe86c8b7d1bc489905f86:v0.63.1@sha256:16eca97b649f6f27dfbab2be167be0afc34bab43af9d3304f64bf7f04d44e606
        livenessProbe:
          httpGet:
            path: /health
            port: 9097
        name: tekton-dashboard
        ports:
        - containerPort: 9097
        readinessProbe:
          httpGet:
            path: /readiness
            port: 9097
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          runAsGroup: 65532
          runAsNonRoot: true
          runAsUser: 65532
          seccompProfile:
            type: RuntimeDefault
      nodeSelector:
        kubernetes.io/os: linux
      serviceAccountName: tekton-dashboard
      volumes: []
---
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apiregistration.k8s.io|APIService|default|v1alpha1.porch.kpt.dev
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch
  name: v1alpha1.porch.kpt.dev
spec:
  group: porch.kpt.dev
  groupPriorityMinimum: 1000
  insecureSkipTLSVerify: true
  service:
    name: api
    namespace: porch-system
  version: v1alpha1
  versionPriority: 15
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|DaemonSet|flox-runtime|flox-runtime-installer
    kpt.dev/package-layer: runtime
    kpt.dev/package-name: flox-containerd-shim
  labels:
    app.kubernetes.io/component: runtime-shim
    app.kubernetes.io/name: flox-runtime-installer
  name: flox-runtime-installer
  namespace: flox-runtime
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: flox-runtime-installer
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: runtime
        kpt.dev/package-name: flox-containerd-shim
      labels:
        app.kubernetes.io/component: runtime-shim
        app.kubernetes.io/name: flox-runtime-installer
    spec:
      containers:
      - image: registry.k8s.io/pause:3.10
        name: pause
        resources:
          limits:
            cpu: 10m
            memory: 64Mi
          requests:
            cpu: 5m
            memory: 32Mi
      hostPID: true
      initContainers:
      - command:
        - /bin/sh
        - -c
        - |
          set -euxo pipefail

          install_deps() {
            local attempt=0
            local max_attempts=${APK_MAX_RETRIES:-5}
            while true; do
              attempt=$((attempt + 1))
              if apk update && apk add --no-cache bash util-linux coreutils >/tmp/apk.log; then
                return 0
              fi
              if [[ ${attempt} -ge ${max_attempts} ]]; then
                echo "apk install failed after ${attempt} attempts" >&2
                sleep infinity
              fi
              sleep $((attempt * 2))
            done
          }

          install_deps

          nsenter --target 1 --mount --uts --inetaddrc --net --pid -- env \
            CONTAINERD_CONFIG_FILE="${CONTAINERD_CONFIG_FILE}" \
            bash <<'HOSTSCRIPT'
          set -euxo pipefail
          export PATH="/var/lib/rancher/rke2/bin:/var/lib/rancher/rke2/agent/bin:${PATH}"
          export FLOX_NO_TELEMETRY=1
          export FLOX_NONINTERACTIVE=1

          CONFIG_FILE="${CONTAINERD_CONFIG_FILE}"
          CONFIG_DIR="$(dirname "${CONFIG_FILE}")"
          CONFIG_TEMPLATE="${CONFIG_DIR}/config.toml.tmpl"
          FLOX_ENV_DIR="/var/lib/flox-runtime/containerd-shim"
          ARCH="$(uname -m)"

          mkdir -p "${FLOX_ENV_DIR}"
          if [[ ! -d "${FLOX_ENV_DIR}/.flox" ]]; then
            (cd "${FLOX_ENV_DIR}" && flox init -b)
          fi

          if command -v containerd >/dev/null 2>&1; then
            CONTAINERD_BIN="$(command -v containerd)"
          elif [[ -x /var/lib/rancher/rke2/bin/containerd ]]; then
            CONTAINERD_BIN="/var/lib/rancher/rke2/bin/containerd"
          elif [[ -x /var/lib/rancher/rke2/agent/bin/containerd ]]; then
            CONTAINERD_BIN="/var/lib/rancher/rke2/agent/bin/containerd"
          else
            echo "containerd binary not found" >&2
            exit 1
          fi

          CONTAINERD_VERSION="$(${CONTAINERD_BIN} --version | awk '{print $3}')"
          CONTAINERD_VERSION="${CONTAINERD_VERSION#v}"
          CONTAINERD_MAJOR="${CONTAINERD_VERSION%%.*}"
          if [[ -z "${CONTAINERD_MAJOR}" ]]; then
            echo "unable to determine containerd version" >&2
            exit 1
          fi
          if [[ "${CONTAINERD_MAJOR}" -ge 2 ]]; then
            SHIM_PKG="flox/containerd-shim-flox-2x"
          else
            SHIM_PKG="flox/containerd-shim-flox-17"
          fi

          flox install --dir "${FLOX_ENV_DIR}" "${SHIM_PKG}"

          SHIM_RUN_DIR="$(find "${FLOX_ENV_DIR}/.flox/run" -maxdepth 1 -name "${ARCH}-linux.containerd-shim*.run" -print -quit || true)"
          if [[ -z "${SHIM_RUN_DIR}" ]]; then
            echo "unable to locate Flox shim run directory" >&2
            exit 1
          fi
          SHIM_PATH="$(realpath "${SHIM_RUN_DIR}")/bin/containerd-shim-flox-v2"
          if [[ ! -f "${SHIM_PATH}" ]]; then
            echo "shim binary missing at ${SHIM_PATH}" >&2
            exit 1
          fi
          install -D -m 0755 "${SHIM_PATH}" /usr/local/bin/containerd-shim-flox-v2

          if [[ ! -f "${CONFIG_TEMPLATE}" ]]; then
            cp "${CONFIG_FILE}" "${CONFIG_TEMPLATE}"
          fi

          CONFIG_VERSION="$(grep -m1 '^version' "${CONFIG_FILE}" | awk -F '=' '{print $2}' | tr -d ' "')"
          if [[ "${CONFIG_VERSION}" == "3" ]]; then
            RUNTIME_SECTION='plugins."io.containerd.cri.v1.runtime".containerd.runtimes.flox'
          else
            RUNTIME_SECTION='plugins."io.containerd.grpc.v1.cri".containerd.runtimes.flox'
          fi

          update_config() {
            local target="$1"
            [[ -f "${target}" ]] || return 0
            local tmp
            tmp="$(mktemp)"
            awk '
              BEGIN {skip=0}
              /^## Flox runtime shim/ {skip=1; next}
              /^\[plugins\..*containerd\.runtimes\.flox/ {skip=1; next}
              skip && /^\[/ && $0 !~ /containerd\.runtimes\.flox/ {skip=0}
              skip {next}
              {print}
            ' "${target}" > "${tmp}"
            mv "${tmp}" "${target}"
            cat <<EOF_BLOCK | sed "s|__RUNTIME_SECTION__|${RUNTIME_SECTION}|" | sed 's/^              //' >> "${target}"
          ## Flox runtime shim
          [__RUNTIME_SECTION__]
            runtime_path = "/usr/local/bin/containerd-shim-flox-v2"
            runtime_type = "io.containerd.runc.v2"
            pod_annotations = [ "flox.dev/*" ]
            container_annotations = [ "flox.dev/*" ]
          [__RUNTIME_SECTION__.options]
            SystemdCgroup = true
          EOF_BLOCK
          }

          update_config "${CONFIG_FILE}"
          update_config "${CONFIG_TEMPLATE}"

          if systemctl is-active rke2-server >/dev/null; then
            systemctl restart rke2-server
          elif systemctl is-active rke2-agent >/dev/null; then
            systemctl restart rke2-agent
          elif systemctl is-active containerd >/dev/null; then
            systemctl restart containerd
          else
            echo "no known service to restart" >&2
          fi
          HOSTSCRIPT
        env:
        - name: CONTAINERD_CONFIG_FILE
          value: /var/lib/rancher/rke2/agent/etc/containerd/config.toml
        - name: CONTAINERD_ADDRESS
          value: /run/k3s/containerd/containerd.sock
        - name: APK_MAX_RETRIES
          value: "5"
        image: alpine:3.20
        imagePullPolicy: IfNotPresent
        name: shim-installer
        securityContext:
          privileged: true
          runAsGroup: 0
          runAsUser: 0
      nodeSelector:
        flox.dev/enabled: "true"
      restartPolicy: Always
      serviceAccountName: flox-runtime-installer
      tolerations:
      - operator: Exists
      volumes: []
  updateStrategy:
    rollingUpdate:
      maxUnavailable: 1
    type: RollingUpdate
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|DaemonSet|${headscale-namespace}|headscale-client
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  labels:
    app: headscale-client
  name: headscale-client
  namespace: headscale-system
spec:
  selector:
    matchLabels:
      app: headscale-client
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: mesh
        kpt.dev/package-name: headscale
      labels:
        app: headscale-client
    spec:
      containers:
      - command:
        - sh
        - -exc
        - |
          set -ex
          echo "Starting tailscaled..."
          tailscaled --tun=userspace-networking \
            --state=/var/lib/tailscale/tailscaled.state \
            --socket=/var/run/tailscale/tailscaled.sock &
          TAILSCALED_PID=$$!

          echo "Waiting for tailscaled socket..."
          until [ -S /var/run/tailscale/tailscaled.sock ]; do sleep 1; done

          # Use internal cluster service (HTTP) - client is inside the cluster
          # External clients use https://alcide-headscale via Tailscale operator
          echo "Connecting to Headscale at $$HEADSCALE_URL..."
          tailscale up \
            --login-server=$$HEADSCALE_URL \
            --authkey=file:/var/secrets/authkey \
            --hostname=$${DARWIN_HOST}-$$RKE2_NODENAME \
            --advertise-tags=tag:rke2,tag:alcide \
            --accept-routes \
            --ssh \
            --reset

          echo "Headscale client connected!"
          wait $$TAILSCALED_PID
        env:
        - name: DARWIN_HOST
          value: alcide
        - name: RKE2_CLUSTER_NAME
          value: alcide
        - name: RKE2_NODENAME
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
        - name: TS_AUTHKEY
          valueFrom:
            secretKeyRef:
              key: authkey
              name: headscale-client-auth
        - name: TS_STATE_DIR
          value: /var/lib/tailscale
        - name: TS_SOCKET
          value: /var/run/tailscale/tailscaled.sock
        - name: TS_USERSPACE
          value: "true"
        - name: TS_KUBE_SECRET
          value: ""
        - name: HEADSCALE_URL
          value: http://headscale.headscale-system.svc.cluster.local:8080
        image: tailscale/tailscale:v1.76.6
        name: tailscale
        resources:
          limits:
            cpu: 200m
            memory: 256Mi
          requests:
            cpu: 50m
            memory: 64Mi
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
            - NET_RAW
          privileged: true
        volumeMounts:
        - mountPath: /dev/net/tun
          name: dev-net-tun
        - mountPath: /var/lib/tailscale
          name: tailscale-state
        - mountPath: /var/run/tailscale
          name: tailscale-socket
        - mountPath: /var/secrets
          name: authkey
          readOnly: true
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true
      hostPID: true
      initContainers:
      - command:
        - sh
        - -exc
        - |
          echo "Waiting for Headscale server..."
          until wget -q -O- "$HEADSCALE_URL/health"; do
            echo "Headscale not ready, retrying in 5s..."
            sleep 5
          done
          echo "Headscale is ready!"
        env:
        - name: HEADSCALE_URL
          value: http://headscale.headscale-system.svc.cluster.local:8080
        image: busybox:1.36
        name: wait-for-headscale
      - command:
        - sh
        - -exc
        - |
          echo "Waiting for auth key Secret..."
          until [ -f /var/secrets/authkey ]; do
            echo "Auth key not available, retrying in 5s..."
            sleep 5
          done
          echo "Auth key found!"
        image: busybox:1.36
        name: wait-for-authkey
        volumeMounts:
        - mountPath: /var/secrets
          name: authkey
      nodeSelector:
        node-role.kubernetes.io/control-plane: "true"
      serviceAccountName: headscale-client
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      volumes:
      - hostPath:
          path: /dev/net/tun
          type: CharDevice
        name: dev-net-tun
      - hostPath:
          path: /var/lib/tailscale
          type: DirectoryOrCreate
        name: tailscale-state
      - emptyDir: {}
        name: tailscale-socket
      - name: authkey
        secret:
          items:
          - key: authkey
            path: authkey
          secretName: headscale-client-auth
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: apps|DaemonSet|${kube-vip-namespace}|kube-vip-ds
    kpt.dev/package-layer: ha
    kpt.dev/package-name: kube-vip
  labels:
    app: kube-vip
  name: kube-vip-ds
  namespace: kube-vip
spec:
  selector:
    matchLabels:
      name: kube-vip-ds
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: ha
        kpt.dev/package-name: kube-vip
      labels:
        app: kube-vip
        name: kube-vip-ds
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: node-role.kubernetes.io/master
                operator: Exists
            - matchExpressions:
              - key: node-role.kubernetes.io/control-plane
                operator: Exists
      containers:
      - args:
        - manager
        env:
        - name: vip_arp
          value: "true"
        - name: port
          value: "6443"
        - name: vip_interface
          value: rke2-vip0
        - name: vip_cidr
          value: "32"
        - name: dns_mode
          value: first
        - name: cp_enable
          value: "true"
        - name: cp_namespace
          value: kube-system
        - name: svc_enable
          value: "false"
        - name: vip_leaderelection
          value: "true"
        - name: vip_leaseduration
          value: "5"
        - name: vip_renewdeadline
          value: "3"
        - name: vip_retryperiod
          value: "1"
        - name: address
          value: 10.80.15.10
        image: ghcr.io/kube-vip/kube-vip:v0.8.7
        imagePullPolicy: Always
        name: kube-vip
        resources:
          limits:
            cpu: 100m
            memory: 128Mi
          requests:
            cpu: 50m
            memory: 64Mi
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
            - NET_RAW
            - SYS_TIME
      hostNetwork: true
      serviceAccountName: kube-vip
      tolerations:
      - effect: NoSchedule
        operator: Exists
      - effect: NoExecute
        operator: Exists
---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: batch|Job|${envoy-gateway-namespace}|envoy-gateway-installer
    kpt.dev/package-layer: networking
    kpt.dev/package-name: envoy-gateway
  name: envoy-gateway-installer
  namespace: envoy-gateway-system
spec:
  backoffLimit: 3
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: networking
        kpt.dev/package-name: envoy-gateway
    spec:
      containers:
      - command:
        - sh
        - -c
        - |
          set -e
          echo "Installing Envoy Gateway v1.4.2..." # kpt-set: Installing Envoy Gateway ${envoy-gateway-version}...
          kubectl apply \
            --server-side \
            --force-conflicts \
            -f https://github.com/envoyproxy/gateway/releases/download/v1.4.2/install.yaml # kpt-set: -f https://github.com/envoyproxy/gateway/releases/download/${envoy-gateway-version}/install.yaml

          echo "Waiting for Envoy Gateway deployment..."
          kubectl wait --timeout=300s \
            --namespace envoy-gateway-system \
            --for=condition=available \
            deployment/envoy-gateway

          echo "Envoy Gateway installation complete!"
        image: alpine/k8s:1.29.8
        name: installer
      restartPolicy: OnFailure
      serviceAccountName: envoy-gateway-installer
  ttlSecondsAfterFinished: 300
---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: batch|Job|${headscale-namespace}|headscale-bootstrap
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: headscale-bootstrap
  namespace: headscale-system
spec:
  template:
    metadata:
      annotations:
        kpt.dev/package-layer: mesh
        kpt.dev/package-name: headscale
    spec:
      containers:
      - command:
        - sh
        - -c
        - |
          set -ex

          # Install dependencies
          apk add --no-cache curl kubectl jq

          echo "Waiting for Headscale server to be ready..."
          until curl -sf http://headscale:8080/health; do
            echo "Headscale not ready, retrying in 5s..."
            sleep 5
          done

          echo "Waiting for headscale pod to be running..."
          until kubectl get pod -n "$HEADSCALE_NAMESPACE" -l app=headscale -o jsonpath='{.items[0].status.phase}' 2>/dev/null | grep -q Running; do
            echo "Headscale pod not ready, retrying in 2s..."
            sleep 2
          done

          # Use kubectl exec to run headscale CLI inside the pod
          # The CLI has direct access to headscale without API key requirements

          echo "Creating admin user..."
          kubectl exec -n "$HEADSCALE_NAMESPACE" deployment/headscale -- \
            headscale users create admin 2>/dev/null || echo "User admin already exists"

          echo "Getting admin user ID..."
          USER_JSON=$$(kubectl exec -n "$HEADSCALE_NAMESPACE" deployment/headscale -- \
            headscale users list -o json)
          USER_ID=$$(echo "$$USER_JSON" | jq -r '.[] | select(.name=="admin") | .id // empty')

          if [ -z "$$USER_ID" ]; then
            echo "ERROR: Failed to get admin user ID"
            echo "User list output: $$USER_JSON"
            exit 1
          fi

          echo "Admin user ID: $$USER_ID"

          echo "Creating reusable preauth key..."
          PREAUTH_JSON=$$(kubectl exec -n "$HEADSCALE_NAMESPACE" deployment/headscale -- \
            headscale preauthkeys --user "$$USER_ID" create \
            --reusable --expiration 720h -o json)

          PREAUTH_KEY=$$(echo "$$PREAUTH_JSON" | jq -r '.key // empty')

          if [ -z "$$PREAUTH_KEY" ]; then
            echo "ERROR: Failed to extract preauth key"
            echo "Preauth key output: $$PREAUTH_JSON"
            exit 1
          fi

          echo "Preauth key created: $${PREAUTH_KEY:0:16}..."

          echo "Storing preauth key in Secret..."
          kubectl create secret generic headscale-client-auth \
            --from-literal=authkey="$$PREAUTH_KEY" \
            --dry-run=client -o yaml | kubectl apply -f -

          echo "Bootstrap complete!"
        env:
        - name: HEADSCALE_NAMESPACE
          value: headscale-system
        image: alpine:3.19
        name: bootstrap
      restartPolicy: OnFailure
      serviceAccountName: headscale-bootstrap
  ttlSecondsAfterFinished: 300
---
apiVersion: cilium.io/v2
kind: CiliumBGPAdvertisement
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumBGPAdvertisement|default|control-plane-advertisement
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: control-plane-advertisement
spec:
  advertisements:
  - advertisementType: Service
    selector:
      matchLabels:
        io.cilium/lb-ipam-pool: load-balancers
    service:
      addresses:
      - ExternalIP
      - LoadBalancerIP
  - advertisementType: PodCIDR
---
apiVersion: cilium.io/v2
kind: CiliumBGPClusterConfig
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumBGPClusterConfig|default|bgp-cluster-config
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: bgp-cluster-config
spec:
  bgpInstances:
  - localASN: 65010
    name: control-plane-bgp
    peers:
    - name: gateway-peer
      peerASN: 65020
      peerAddress: 10.80.8.1
      peerConfigRef:
        name: cilium-peer
  nodeSelector:
    matchLabels:
      node-role.kubernetes.io/control-plane: ""
---
apiVersion: cilium.io/v2alpha1
kind: CiliumL2AnnouncementPolicy
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumL2AnnouncementPolicy|default|home-lan-policy
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: home-lan-policy
spec:
  interfaces:
  - ^lan0$
  loadBalancerIPs: true
  nodeSelector:
    matchExpressions:
    - key: node-role.kubernetes.io/control-plane
      operator: Exists
  serviceSelector:
    matchLabels:
      io.cilium/lb-ipam-pool: home-lan
---
apiVersion: cilium.io/v2alpha1
kind: CiliumL2AnnouncementPolicy
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumL2AnnouncementPolicy|default|host
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: host
spec:
  interfaces:
  - eth0
  - lan0
  loadBalancerIPs: true
  nodeSelector:
    matchExpressions:
    - key: node-role.kubernetes.io/control-plane
      operator: Exists
  serviceSelector:
    matchLabels: {}
---
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumLoadBalancerIPPool|default|home-lan
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: headscale
  name: home-lan
spec:
  blocks:
  - cidr: 192.168.1.64/27
  serviceSelector:
    matchLabels:
      io.cilium/lb-ipam-pool: home-lan
---
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumLoadBalancerIPPool|default|lan-load-balancers
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: lan-load-balancers
spec:
  blocks:
  - cidr: 192.168.1.64/27
  serviceSelector:
    matchLabels:
      io.cilium/loadbalancer-ip-pool: lan-lb
---
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumLoadBalancerIPPool|default|load-balancers
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: load-balancers
spec:
  blocks:
  - cidr: 10.80.8.64/26
  serviceSelector:
    matchExpressions:
    - key: io.cilium/lb-ipam-pool
      operator: DoesNotExist
---
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: cilium.io|CiliumLoadBalancerIPPool|default|virtual-addresses
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-advanced
  name: virtual-addresses
spec:
  blocks:
  - cidr: 10.80.15.0/24
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|ha-kube-vip
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: ha-kube-vip
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: ha/kube-vip
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: kube-vip
    nxmatic.dev/component: ha
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        cluster-node-vip-inetaddr: 10.80.15.10
        cluster-vip-interface: rke2-vip0
        kube-vip-namespace: kube-vip
        kube-vip-version: ${kube-vip-version}
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: ha/kube-vip
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|mesh-headscale
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: mesh-headscale
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: mesh/headscale
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: headscale
    nxmatic.dev/component: mesh
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        cluster-lan-headscale-inetaddr: 192.168.1.65
        cluster-lan-lb-cidr: 192.168.1.64/27
        cluster-name: alcide
        cluster-vip-cidr: 10.80.15.0/24
        darwin-host: alcide
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: mesh/headscale
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|mesh-tailscale
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: mesh-tailscale
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: mesh/tailscale
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: tailscale
    nxmatic.dev/component: mesh
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        cluster-lb-cidr: 10.80.8.64/26
        cluster-name: alcide-cluster
        cluster-node-vip-inetaddr: 10.80.15.10
        tailscale-namespace: tailscale-system
        tailscale-version: 1.82.0
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: mesh/tailscale
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|networking-cilium
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: networking-cilium
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: networking/cilium
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: cilium
    nxmatic.dev/component: networking
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        bgp-local-asn: "65001"
        bgp-peer-asn: "65000"
        cluster-id: 1
        cluster-lb-cidr: 10.80.8.64/26
        cluster-name: alcide-cluster
        cluster-node-gateway-inetaddr: 10.80.8.1
        cluster-vip-cidr: 10.80.15.0/24
        l2-interface-1: vmnet0
        l2-interface-2: lan0
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: networking/cilium
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|networking-envoy-gateway
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: networking-envoy-gateway
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: networking/envoy-gateway
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: envoy-gateway
    nxmatic.dev/component: networking
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        envoy-gateway-namespace: envoy-gateway-system
        envoy-gateway-version: v1.4.2
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: networking/envoy-gateway
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|runtime-flox
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: runtime-flox
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: runtime/flox-containerd-shim
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: flox-containerd-shim
    nxmatic.dev/component: runtime
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        apk-max-retries: "5"
        containerd-address: /run/k3s/containerd/containerd.sock
        containerd-config-file: /var/lib/rancher/rke2/agent/etc/containerd/config.toml
        flox-namespace: flox
        node-label-key: flox.dev/enabled
        node-label-value: "true"
        runtime-class-name: flox
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: runtime/flox-containerd-shim
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: PackageVariant
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|PackageVariant|porch-system|storage-openebs-zfs
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: storage-openebs-zfs
  namespace: porch-system
spec:
  adoptionPolicy: adoptNone
  deletionPolicy: delete
  downstream:
    package: storage-openebs-zfs
    repo: alcide-state
  labels:
    cluster-name: alcide
    nxmatic.dev/app: openebs-zfs
    nxmatic.dev/component: storage
  packageContext:
    data:
      cluster-env: dave
      cluster-name: alcide
  pipeline:
    mutators:
    - configMap:
        kubelet-dir: /var/lib/kubelet
        zfs-pool-name: tank
      image: ghcr.io/kptdev/krm-functions-catalog/apply-setters:v0.2
  upstream:
    package: storage-openebs-zfs
    repo: alcide-catalog
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: Repository
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|Repository|porch-system|${cluster-name}-catalog
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: alcide-catalog
  namespace: porch-system
spec:
  deployment: true
  description: Catalog of curated kpt packages tracked in rke2lab
  git:
    branch: main
    directory: catalog
    repo: https://github.com/nxmatic/rke2lab.git
    secretRef: ${github-secret}
  type: git
---
apiVersion: config.porch.kpt.dev/v1alpha1
kind: Repository
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: config.porch.kpt.dev|Repository|porch-system|cluster-name-state
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: porch-resources
  name: alcide-state
  namespace: porch-system
spec:
  deployment: true
  description: Rendered Porch package state for alcide cluster
  git:
    branch: main
    createBranch: true
    directory: rke2/alcide/catalog
    repo: https://github.com/nxmatic/rke2lab.git
    secretRef: ${github-secret}
  type: git
---
apiVersion: fluxcd.controlplane.io/v1
kind: FluxInstance
metadata:
  annotations:
    kpt.dev/package-layer: gitops
    kpt.dev/package-name: flux-instance
  labels:
    app.kubernetes.io/instance: flux-instance
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: flux-instance
    app.kubernetes.io/version: v0.36.0
    helm.sh/chart: flux-instance-0.36.0
  name: flux
  namespace: flux-system
spec:
  cluster:
    domain: cluster.local
    multitenant: false
    networkPolicy: true
    tenantDefaultServiceAccount: default
    type: kubernetes
  components:
  - source-controller
  - kustomize-controller
  - helm-controller
  - notification-controller
  distribution:
    artifact: oci://ghcr.io/controlplaneio-fluxcd/flux-operator-manifests:latest
    registry: ghcr.io/fluxcd
    version: 2.x
  kustomize:
    patches: []
---
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: gateway.networking.k8s.io|GatewayClass|default|envoy
    kpt.dev/package-layer: networking
    kpt.dev/package-name: envoy-gateway
  name: envoy
spec:
  controllerName: gateway.envoyproxy.io/gatewayclass-controller
---
apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: helm.cattle.io|HelmChart|kube-system|tailscale-operator
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: tailscale
  name: tailscale-operator
  namespace: kube-system
spec:
  chart: tailscale-operator
  createNamespace: true
  repo: https://pkgs.tailscale.com/helmcharts
  targetNamespace: tailscale-system
  valuesContent: |-
    operatorConfig:
      debug: true
  version: 1.82.0
---
apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: helm.cattle.io|HelmChart|openebs|openebs-zfs
    kpt.dev/package-layer: storage
    kpt.dev/package-name: openebs-zfs
  name: openebs-zfs
  namespace: openebs
spec:
  chart: zfs-localpv
  createNamespace: true
  repo: https://openebs.github.io/zfs-localpv
  targetNamespace: openebs
  valuesContent: |-
    zfs:
      bin: /usr/sbin/zfs
    zfsNode:
      kubeletDir: /var/lib/kubelet
  version: 2.8.0
---
apiVersion: helm.cattle.io/v1
kind: HelmChartConfig
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: helm.cattle.io|HelmChartConfig|kube-system|rke2-cilium
    kpt.dev/package-layer: networking
    kpt.dev/package-name: cilium-config
  name: rke2-cilium
  namespace: kube-system
spec:
  valuesContent: |-
    installCRDs: true
    bpf:
      hostLegacyRouting: true
    bgpControlPlane:
      enabled: true
    cluster:
      name: sample
      id: 7
    clustermesh:
      enabled: true
      useAPIServer: true
      apiserver:
        enabled: true
        service:
          type: LoadBalancer
          # Using BGP announcements for cluster mesh
    envoy:
      enabled: true
    gatewayAPI:
      enabled: true
    ingressController:
      default: true
      enabled: true
      loadBalancerMode: dedicated
    hubble:
      enabled: true
      relay:
        enabled: true
      ui:
        enabled: true
    ipv4:
      enabled: true
    ipv6:
      enabled: false
    kubeProxyReplacement: true
    l2announcements:
      enabled: true
      leaseDuration: 15s
      leaseRenewDeadline: 5s
      leaseRetryPeriod: 2s
    l2NeighDiscovery:
      enabled: true
      refresh: true
      refreshPeriod: 30s
    l7Proxy: true
    routingMode: tunnel
    tunnelProtocol: vxlan
    operator:
      replicas: 1
      podDisruptionBudget:
        enabled: true
    socketLB:
      enabled: true
---
apiVersion: helm.cattle.io/v1
kind: HelmChartConfig
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: helm.cattle.io|HelmChartConfig|kube-system|rke2-traefik
    kpt.dev/package-layer: networking
    kpt.dev/package-name: traefik
  name: rke2-traefik
  namespace: kube-system
spec:
  valuesContent: |-
    additionalArguments:
      - "--api.insecure=true"
    ports:
      web:
        expose:
          default: true
      websecure:
        expose:
          default: true
    service:
      type: LoadBalancer
      labels:
        io.cilium/loadbalancer-ip-pool: lan-lb
      spec:
        externalTrafficPolicy: Local
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: networking.k8s.io|Ingress|tekton-pipelines|tekton-dashboard
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
    kube-vip.io/address-pool: lan-lb
    traefik.ingress.kubernetes.io/router.entrypoints: web
    traefik.ingress.kubernetes.io/router.middlewares: tekton-dashboard-strip@kubernetescrd
  name: tekton-dashboard
  namespace: tekton-pipelines
spec:
  ingressClassName: traefik
  rules:
  - host: alcide-web-proxy.lan
    http:
      paths:
      - backend:
          service:
            name: tekton-dashboard
            port:
              number: 9097
        path: /tekton
        pathType: Prefix
---
apiVersion: node.k8s.io/v1
handler: flox
kind: RuntimeClass
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: node.k8s.io|RuntimeClass|default|flox
    kpt.dev/package-layer: runtime
    kpt.dev/package-name: flox-containerd-shim
  name: flox
scheduling:
  nodeSelector:
    flox.dev/enabled: "true"
---
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: operator.tekton.dev|TektonConfig|default|config
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-pipelines
  name: config
spec:
  profile: all
  pruner:
    keep: 100
    resources:
    - taskrun
    - pipelinerun
    schedule: 0 8 * * *
  result:
    disabled: true
  targetNamespace: tekton-pipelines
---
apiVersion: tailscale.com/v1alpha1
kind: Connector
metadata:
  annotations:
    config.kubernetes.io/depends-on: helm.cattle.io/namespaces/kube-system/HelmChart/tailscale-operator
    internal.kpt.dev/upstream-identifier: tailscale.com|Connector|default|controlplane
    kpt.dev/package-layer: mesh
    kpt.dev/package-name: tailscale
  name: controlplane
spec:
  hostname: alcide-controlplane
  subnetRouter:
    advertiseRoutes:
    - 10.80.15.10/32
    - 10.80.8.64/26
---
apiVersion: traefik.containo.us/v1alpha1
kind: Middleware
metadata:
  annotations:
    internal.kpt.dev/upstream-identifier: traefik.containo.us|Middleware|tekton-pipelines|tekton-dashboard-strip
    kpt.dev/package-layer: cicd
    kpt.dev/package-name: tekton-dashboard
  name: tekton-dashboard-strip
  namespace: tekton-pipelines
spec:
  stripPrefix:
    prefixes:
    - /tekton
